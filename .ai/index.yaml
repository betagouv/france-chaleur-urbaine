# AI Context Index
# Purpose: Help AI agents find and load the right context files for any task
# Usage: Match task keywords with file keywords, load 2-4 most relevant files

instructions: |
  HOW TO USE THIS INDEX:
  
  1. EXTRACT keywords from the task (e.g., "form", "database", "test")
  2. MATCH task keywords with file keywords below
  3. LOAD files with most keyword matches (2-4 files max)
  4. SPECIAL CASES:
     - Big task/refactor/new feature → ALWAYS load ARCHITECTURE.md
     - Working in src/modules/X/ → ALWAYS load src/modules/X/AGENTS.md
  
  LANGUAGE: All code in English (functions, variables, comments, logs, docs, commits)
  French only for: UI text if requested, or conversational responses
  
  FILE TYPES: TypeScript only (.ts, .tsx). Never search .py, .java, .rb, .php

files:
  # ARCHITECTURE (project specifics: modules, legacy, migration)
  - path: "ARCHITECTURE.md"
    topic: "Project Architecture"
    summary: "FCU project specifics: modules list, legacy areas, migration plan, directory structure"
    keywords: ["architecture", "modules", "legacy", "migration", "structure", "overview", "organization", "refactor"]

  - path: ".ai/context/architecture.md"
    topic: "Architecture Principles"
    summary: "General principles: module system, Pages Router, client/server separation, imports rules"
    keywords: ["principles", "conventions", "Pages Router", "client/server", "imports", "module rules"]

  - path: ".ai/context/modules.md"
    topic: "Module System"
    summary: "Module structure, AGENTS.md requirement, CLI commands, internal imports"
    keywords: ["module", "src/modules", "AGENTS.md", "CLI", "commands.ts", "server.ts", "client.ts", "structure"]

  # BACKEND
  - path: ".ai/context/backend.md"
    topic: "Backend/APIs"
    summary: "TRPC preferred, business logic in services, logging, error handling"
    keywords: ["API", "TRPC", "endpoint", "server", "service", "backend", "route", "logic"]

  - path: ".ai/context/database.md"
    topic: "Database Queries"
    summary: "Kysely typed queries, PostGIS, performance (columns, indexes)"
    keywords: ["database", "Kysely", "PostgreSQL", "PostGIS", "query", "SQL", "kdb", "geometry", "spatial"]

  - path: ".ai/context/migrations.md"
    topic: "Database Migrations"
    summary: "Knex migrations, schema changes, PostGIS, pnpm db:sync workflow"
    keywords: ["migration", "schema", "table", "column", "ALTER", "CREATE", "db:migrate", "db:sync"]

  - path: ".ai/context/errors.md"
    topic: "Error Handling"
    summary: "TRPCError, toastErrors, logger, no PII in logs"
    keywords: ["error", "exception", "TRPCError", "logger", "logging", "throw", "catch", "toastErrors"]

  # FRONTEND
  - path: ".ai/context/frontend.md"
    topic: "Frontend/React"
    summary: "React patterns, DSFR, state (tRPC/Jotai/nuqs), UI components"
    keywords: ["React", "component", "frontend", "UI", "DSFR", "client", "state", "Jotai", "nuqs", "style"]

  - path: ".ai/context/forms.md"
    topic: "Forms"
    summary: "Tanstack React Form + Zod, DSFR form components, validation"
    keywords: ["form", "input", "validation", "Zod", "useForm", "submit", "field", "schema", "Tanstack"]

  - path: ".ai/context/map.md"
    topic: "Maps"
    summary: "MapLibre GL layers, tiles generation, map configuration"
    keywords: ["map", "MapLibre", "layer", "tiles", "geospatial", "GeoJSON", "coordinates", "marker"]

  # CODE QUALITY
  - path: ".ai/context/coding-style.md"
    topic: "Code Style"
    summary: "TypeScript conventions: names, types, guard clauses, no default exports"
    keywords: ["style", "convention", "TypeScript", "naming", "types", "interfaces", "export", "format"]

  - path: ".ai/context/testing.md"
    topic: "Testing"
    summary: "Vitest patterns, *.spec.ts vs *.test.ts, coverage, Testing Library"
    keywords: ["test", "spec", "Vitest", "testing", "coverage", "expect", "describe", "it", "unit"]

  - path: ".ai/context/security.md"
    topic: "Security"
    summary: "Zod validation, env secrets, permissions, no PII"
    keywords: ["security", "validation", "auth", "permissions", "secrets", "env", "PII", "sanitize"]

  # REFERENCE
  - path: ".ai/context/dev.md"
    topic: "Commands"
    summary: "pnpm commands: dev, lint, test, db:migrate, db:sync, build"
    keywords: ["command", "pnpm", "dev", "build", "test", "lint", "migrate", "workflow"]

  - path: ".ai/context/stack.md"
    topic: "Tech Stack"
    summary: "Next.js 16, TypeScript 5, DSFR, tRPC, Kysely, PostgreSQL, MapLibre"
    keywords: ["stack", "technology", "version", "dependencies", "tools", "framework", "Next.js"]

  - path: ".ai/context/docs.md"
    topic: "Documentation"
    summary: "Doc standards: ≤600 tokens, modular, links to ARCHITECTURE/AGENTS.md"
    keywords: ["documentation", "docs", "README", "AGENTS.md", "comments", "writing", "standards"]

  - path: ".ai/context/testing.md"
    type: "rules"
    topic: "Tests"
    summary: "Testing guidelines, patterns, helpers, best practices."

