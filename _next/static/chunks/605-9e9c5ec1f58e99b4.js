"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[605],{3178:function(e,t,n){n.d(t,{Z:function(){return E}});var r,i=n(341),o=n(7294),a=n(7379),c=n(5893),u=function(e){var t=e.children,n=e.name,r=void 0===n?"address":n,i=e.centred,o="fr-text--lg fr-my-2w fr-grid-row ".concat(i?"fr-grid-row--center":"fr-grid-row--left");return(0,c.jsx)("label",{className:o,htmlFor:r,children:(0,c.jsx)("span",{children:t})})},s=function(e){var t=e.placeholder,n=void 0===t?"":t,r=e.onChange;return(0,c.jsx)(i.gA,{className:"fr-input",type:"text",id:"address",name:"address",placeholder:n,onChange:r})},l=function(e){var t=e.text,n=void 0===t?"Aucune adresse trouv\xe9e :(":t;return(0,c.jsx)("p",{style:{margin:0,color:"#454545",padding:"0.25rem 1rem 0.75rem 1rem",fontStyle:"italic"},children:n})},d=function(e){var t=e.suggestions;return(0,c.jsx)(i.Gk,{children:t.map((function(e,t){var n=e.properties;return(0,c.jsx)(i.O2,{value:n.label},n.id+t)}))})},f=n(29),g=n(6835),v=n(7794),m=n.n(v),p=n(7954),b=n.n(p),h=n(3598);!function(e){e.Idle="idle",e.Loading="loading",e.Success="success",e.Error="error"}(r||(r={}));var y=function(e){var t=e.limit,n=void 0===t?5:t,i=e.autocomplete,a=void 0!==i&&i,c=e.debounceTime,u=void 0===c?300:c,s=e.minCharactersLength,l=void 0===s?3:s,d=o.useState([]),v=(0,g.Z)(d,2),p=v[0],y=v[1],w=o.useState(r.Idle),E=(0,g.Z)(w,2),O=E[0],k=E[1],S=o.useRef(!0),j=(0,h.Su)().suggestionService,x=b()(function(){var e=(0,f.Z)(m().mark((function e(t){var i,o;return m().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,(i=t.trim())&&S.current&&!(i.length<=3)){e.next=4;break}return e.abrupt("return");case 4:return k(r.Loading),e.next=7,j.fetchSuggestions(i,{limit:n.toString(),autocomplete:a.toString()});case 7:o=e.sent,y(o.features),k(r.Success),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(0),k(r.Error),console.error({error:e.t0});case 16:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(t){return e.apply(this,arguments)}}(),u);return o.useEffect((function(){return function(){S.current=!1}}),[]),{suggestions:p,status:O,fetchSuggestions:function(e){return e.length>=l&&x(e)}}},w=(0,a.vJ)([".fr-input{transition:box-shadow .5s ease;color:#000074;:focus{box-shadow:inset 0 -2px 0 0 #000074;}}.fr-input-wrap{box-shadow:0 0 5px rgb(0 0 0 / 74%);border-radius:.25rem .25rem 0 0;}"]),E=function(e){var t=e.label,n=void 0===t?"":t,r=e.emptySuggestionText,a=e.debounceTime,f=void 0===a?200:a,g=e.minCharactersLength,v=void 0===g?3:g,m=e.placeholder,p=void 0===m?"Recherchez une adresse":m,b=e.className,h=e.popoverClassName,E=e.centred,O=e.onAddressSelected,k=e.onChange,S=y({debounceTime:f,limit:5,autocomplete:!1,minCharactersLength:v}),j=S.suggestions,x=S.fetchSuggestions,C=S.status,T=(0,o.useCallback)((function(e,t){var n=function(e,t){return t.find((function(t){return t.properties.label===e}))}(e,t),r=(null===n||void 0===n?void 0:n.geometry.coordinates)||[0,0];O(e,r,n)}),[O]),A=(0,o.useMemo)((function(){return"idle"!==C&&"loading"!==C}),[C]),I=(0,o.useMemo)((function(){return!!j.length}),[j]);return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(w,{}),(0,c.jsxs)("div",{className:"fr-input-group ".concat(b||""),children:[n&&(0,c.jsx)(u,{centred:E,children:n}),(0,c.jsxs)(i.hQ,{"aria-label":"address","aria-labelledby":"address",className:"fr-input-wrap fr-fi-search-line",onSelect:function(e){return T(e,j)},children:[(0,c.jsx)(s,{onChange:function(e){var t=e.currentTarget.value;k&&k(t),x(t)},placeholder:p}),A&&(0,c.jsx)(i.SF,{className:h,children:I?(0,c.jsx)(d,{suggestions:j}):(0,c.jsx)(l,{text:r})})]})]})]})}},5873:function(e,t,n){n.d(t,{z$:function(){return d},ki:function(){return v},y_:function(){return i},aI:function(){return g}});var r=["75","77","78","91","92","93","94","95"],i=function(e){return r.includes(e.slice(0,2))},o=n(29),a=n(7794),c=n.n(a),u=function(e,t){if(!e||!t)return!1;var n="".concat(e<=100?"< 100m":e<=200?"> 100m et < 200m":"> 200m",", ").concat(t);return!["< 100m, collectif","< 100m, individuel","> 100m et < 200m, collectif","> 100m et < 200m, individuel","> 200m, collectif","> 200m, individuel"].includes(n)&&n},s=function(e){switch(e){case"\xe9lectricit\xe9":return"\xc9lectricit\xe9";case"gaz":return"Gaz";case"fioul":return"Fioul";default:return"Autre / Je ne sais pas"}},l=function(e){switch(e){case"individuel":return"Individuel";case"collectif":return"Collectif";default:return"Autre / Je ne sais pas"}},d=function(e){var t=e.address,n=e.eligibility,r=e.heatingEnergy,i=e.heatingType,o=e.network,a=e.structure,c=e.firstName,d=e.lastName,f=e.company,g=e.email,v=e.dataRetention,m=e.dataSharing;return{Nom:d,"Pr\xe9nom":c,Structure:a,"\xc9tablissement":f,"\xc9ligibilit\xe9":n,Adresse:t,Mail:g,"Mode de chauffage":s(r),"Type de chauffage":l(i),"Distance au r\xe9seau":null===o||void 0===o?void 0:o.distance,"Choix en fonction de la distance au r\xe9seau":u(null===o||void 0===o?void 0:o.distance,i)||"inconnue","J\u2019accepte que les donn\xe9es collect\xe9es soient utilis\xe9es \xe0 des fins d\u2019analyse par le minist\xe8re de la transition \xe9cologique.":v,"J\u2019accepte que ma demande soit communiqu\xe9e \xe0 ma commune et au gestionnaire du r\xe9seau le plus proche (sans aucun engagement de ma part)":m}},f=function(){var e=(0,o.Z)(c().mark((function e(t,n){var r;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"./api/airtable/create-record",e.next=3,fetch("./api/airtable/create-record",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});case 3:if(r=e.sent,!n){e.next=8;break}return e.abrupt("return",n(r,t));case 8:return e.abrupt("return",r);case 9:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),g=f,v=function(e){var t=e.address,n=e.coords,r=e.eligibility,i=e.heatingEnergy,o=e.heatingType,a=e.network,c=e.structure,u=e.firstName;return{Nom:e.lastName||"","Pr\xe9nom":u||"","\xc9tablissement":e.company||"",Email:e.email||"",Structure:c||"",Chauffage:"".concat(i," - ").concat(o),Adresse:{coords:[n.lat,n.lon],label:t||""},"Distance au r\xe9seau":null!==a&&void 0!==a&&a.distance?"".concat(a.distance,"m"):"inconnue","\xc9ligiblit\xe9":r,"Accord pour la collecte des donn\xe9es":!0,"Accord pour partage au gestionnaire":!0}}},103:function(e,t,n){n.d(t,{qO:function(){return S},Co:function(){return x},V_:function(){return T},rc:function(){return A}});var r=n(6835),i=n(1692),o=n(5873),a=function(){var e=(0,i.H)({formId:"8ccEEqGt"}),t=(0,r.Z)(e,2),n=t[0];return[function(e){return Promise.all([n((0,o.ki)(e)),(0,o.aI)((0,o.z$)(e))])},t[1]]},c=n(9499),u=n(29),s=n(7794),l=n.n(s),d=n(7812),f=n(7294),g=(n(5893),function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return"function"===typeof(null===(t=window)||void 0===t?void 0:t.fbq)&&window.fbq(["track"].concat((0,d.Z)(e),(0,d.Z)(n)))}),v=function(e,t){var n,i=(0,r.Z)(t,1)[0];return"function"===typeof(null===(n=window)||void 0===n?void 0:n.gtag)&&window.gtag("event","conversion",{send_to:"AW-".concat(e,"/").concat(i)})},m=function(e){var t,n=(0,r.Z)(e,1)[0];return"function"===typeof(null===(t=window)||void 0===t?void 0:t.lintrk)&&window.lintrk("track",{conversion_id:n})},p=JSON.parse('{"eligibilityTest":{"linkedInEvent":[5492674],"facebookEvent":["FindLocation"],"googleAdsEvent":["7ZZ6CJL-9YIDEMrY_5oo"],"matomoEvent":["Eligibilit\xe9","Formulaire de test - Envoi"]},"eligibilityTestOK":{"linkedInEvent":[5392842],"googleAdsEvent":["xmLwCPqp5P0CEMrY_5oo"],"matomoEvent":["Eligibilit\xe9","Formulaire de test - Adresse \xc9ligible"]},"eligibilityTestKO":{"linkedInEvent":[5492666],"googleAdsEvent":["4BLdCLqy_oIDEMrY_5oo"],"matomoEvent":["Eligibilit\xe9","Formulaire de test - Adresse In\xe9ligible"]},"eligibilityTestUnknow":{"linkedInEvent":[5492682],"googleAdsEvent":["4BLdCLqy_oIDEMrY_5oo"],"matomoEvent":["Eligibilit\xe9","Formulaire de test - Adresse Inconnue"]},"contactFormEligible":{"facebookEvent":["Contact"],"matomoEvent":["Eligibilit\xe9","Formulaire de contact \xe9ligible - Envoi"]},"contactFormIneligible":{"facebookEvent":["Contact"],"matomoEvent":["Eligibilit\xe9","Formulaire de contact in\xe9ligible - Envoi"]}}');function b(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?b(Object(n),!0).forEach((function(t){(0,c.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):b(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var y=function(){var e,t,n,i,o;return null===(e=window)||void 0===e||null===(t=e.tarteaucitron)||void 0===t||null===(n=t.proTemp)||void 0===n||null===(i=n.split("!"))||void 0===i||null===(o=i.reduce((function(e,t){var n=t.split("="),i=(0,r.Z)(n,2),o=i[0],a=i[1];return h(h({},e),{},(0,c.Z)({},o,"false"!==a))}),{}))||void 0===o?void 0:o.matomo},w=function(e){var t,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return"function"===typeof(null===(t=window)||void 0===t||null===(n=t._paq)||void 0===n?void 0:n.push)&&window._paq.push(["trackEvent"].concat((0,d.Z)(e),(0,d.Z)(y()?r:["Consentement non accord\xe9"])))};function E(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function O(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?E(Object(n),!0).forEach((function(t){(0,c.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):E(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var k=function(e){var t=e.estEligible,n=e.address,r=t?"contactFormEligible":"contactFormIneligible";w(p[r].matomoEvent,[n]),g(p[r].facebookEvent)},S=function(){var e=(0,f.useRef)(null),t=(0,f.useState)({}),n=t[0],i=t[1],o=(0,f.useState)(!1),c=o[0],s=o[1],d=(0,f.useState)(!1),b=d[0],h=d[1],y=(0,f.useState)(!1),E=y[0],S=y[1],j=(0,f.useState)("idle"),x=j[0],C=j[1],T=a(),A=(0,r.Z)(T,1)[0],I=(0,f.useCallback)((function(t,n){return window.setTimeout((function(){var t=e.current;null===t||void 0===t||t.scrollIntoView({behavior:"smooth"}),n&&n()}),t)}),[]),P=(0,f.useCallback)((function(e){var t=e.address,n=e.heatingType;i(e),h(t&&!n)}),[]),Z=(0,f.useCallback)((function(e){var t=e.address,r=n.heatingType;C("loading"),S(!1),function(e){w(p.eligibilityTest.matomoEvent,[e]),m(p.eligibilityTest.linkedInEvent),g(p.eligibilityTest.facebookEvent),v("10794036298",p.eligibilityTest.googleAdsEvent)}(t),h(t&&!r)}),[n]),N=(0,f.useCallback)((function(e){var t=e.address,n=e.heatingType;if(function(e){var t=e.eligibility,n=e.address;t?(w(p.eligibilityTestOK.matomoEvent,[n||"Adresse indefini"]),m(p.eligibilityTestOK.linkedInEvent),v("10794036298",p.eligibilityTestOK.googleAdsEvent)):(w(p.eligibilityTestKO.matomoEvent,[n||"Adresse indefini"]),m(p.eligibilityTestKO.linkedInEvent),v("10794036298",p.eligibilityTestKO.googleAdsEvent))}({eligibility:e.eligibility,address:t}),i(e),t&&n){s(!0);var r=I(500,(function(){return C("loaded")}));return function(){return window.clearTimeout(r)}}}),[I]),_=(0,f.useCallback)((0,u.Z)(l().mark((function e(){var t,r,o=arguments;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"Tertiaire"!==(t=o.length>0&&void 0!==o[0]?o[0]:{}).structure&&(t.company=""),k(t),e.next=5,A(t);case 5:return r=I(500),i(O(O({},n),t)),S(!0),e.abrupt("return",(function(){return window.clearTimeout(r)}));case 9:case"end":return e.stop()}}),e)}))),[n,A,I]);return{EligibilityFormContactRef:e,addressData:n,contactReady:c,showWarning:b,messageSent:E,loadingStatus:x,warningMessage:"N'oubliez pas d'indiquer votre type de chauffage.",handleOnChangeAddress:P,handleOnFetchAddress:Z,handleOnSuccessAddress:N,handleOnSubmitContact:_}},j=n(5934),x=function(e){var t=e.id,n=e.name,r=(0,f.useRef)((0,j.Z)());return(0,f.useMemo)((function(){return"".concat(t||n||"id","-").concat(r.current)}),[n,t])},C="__FCU:App__";var T=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.beforeStorage,i=void 0===r?function(){}:r,o=n.keyPrefix,a=void 0===o?C:o,c=(0,f.useState)(t),u=c[0],s=c[1],l=(0,f.useMemo)((function(){return"".concat(a,"-").concat(e)}),[a,e]),d=(0,f.useRef)(l),g=(0,f.useCallback)((function(e,t){return window.localStorage.setItem(e,JSON.stringify(i(t)))}),[i]);return(0,f.useEffect)((function(){try{var e=window.localStorage.getItem(l);null!==e&&s(JSON.parse(e))}catch(t){console.error(t)}}),[l]),(0,f.useEffect)((function(){try{g(d.current,u)}catch(e){console.error(e)}}),[g,u]),(0,f.useEffect)((function(){var e=d.current;if(l!==e)try{g(l,u),d.current=l,window.localStorage.removeItem(e)}catch(t){console.error(t)}}),[l,g,u]),[u,s]};var A=function(e){var t=(0,f.useRef)();return(0,f.useEffect)((function(){t.current=e}),[e]),t.current}}}]);