"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[149],{948:function(e,t,n){n.d(t,{Z:function(){return w}});var r,i=n(5336),o=n(7294),a=n(2125),c=(0,a.vJ)([".fr-input{transition:box-shadow .5s ease;color:#000074;:focus{box-shadow:inset 0 -2px 0 0 #000074;}}.fr-input-wrap{box-shadow:0 0 5px rgb(0 0 0 / 74%);border-radius:.25rem .25rem 0 0;}"]),s=a.ZP.p.withConfig({displayName:"AddressAutocompletestyle__EmptySuggestion",componentId:"sc-1ovnvsa-0"})(["margin:0;color:'#454545';padding:'0.25rem 1rem 0.75rem 1rem';font-style:'italic';"]),u=n(5893),l=function(e){var t=e.children,n=e.name,r=void 0===n?"address":n,i=e.centred,o="fr-text--lg fr-my-2w fr-grid-row ".concat(i?"fr-grid-row--center":"fr-grid-row--left");return(0,u.jsx)("label",{className:o,htmlFor:r,children:(0,u.jsx)("span",{children:t})})},d=function(e){var t=e.placeholder,n=void 0===t?"":t,r=e.onChange;return(0,u.jsx)(i.gA,{className:"fr-input",type:"text",id:"address",name:"address",placeholder:n,onChange:r})},f=function(e){var t=e.suggestions;return(0,u.jsx)(i.Gk,{children:t.map((function(e,t){var n=e.properties;return(0,u.jsx)(i.O2,{value:n.label},n.id+t)}))})},g=n(29),v=n(7794),m=n.n(v),p=n(7954),b=n.n(p),h=n(3598);!function(e){e.Idle="idle",e.Loading="loading",e.Success="success",e.Error="error"}(r||(r={}));var y=function(e){var t=e.limit,n=void 0===t?5:t,i=e.autocomplete,a=void 0!==i&&i,c=e.debounceTime,s=void 0===c?300:c,u=e.minCharactersLength,l=void 0===u?3:u,d=(0,o.useState)([]),f=d[0],v=d[1],p=(0,o.useState)(r.Idle),y=p[0],w=p[1],O=(0,o.useRef)(!0),E=(0,h.Su)().suggestionService,j=b()(function(){var e=(0,g.Z)(m().mark((function e(t){var i,o;return m().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,(i=t.trim())&&O.current&&!(i.length<=3)){e.next=4;break}return e.abrupt("return");case 4:return w(r.Loading),e.next=7,E.fetchSuggestions(i,{limit:n.toString(),autocomplete:a.toString()});case 7:o=e.sent,v(o.features),w(r.Success),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(0),w(r.Error),console.error({error:e.t0});case 16:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(t){return e.apply(this,arguments)}}(),s);return(0,o.useEffect)((function(){return function(){O.current=!1}}),[]),{suggestions:f,status:y,fetchSuggestions:function(e){return e.length>=l&&j(e)}}},w=function(e){var t=e.label,n=void 0===t?"":t,r=e.emptySuggestionText,a=void 0===r?"Aucune adresse trouv\xe9e :(":r,g=e.debounceTime,v=void 0===g?200:g,m=e.minCharactersLength,p=void 0===m?3:m,b=e.placeholder,h=void 0===b?"Recherchez une adresse":b,w=e.className,O=e.popoverClassName,E=e.centred,j=e.onAddressSelected,S=e.onChange,k=y({debounceTime:v,limit:5,autocomplete:!1,minCharactersLength:p}),C=k.suggestions,P=k.fetchSuggestions,T=k.status,x=(0,o.useCallback)((function(e,t){var n=function(e,t){return t.find((function(t){return t.properties.label===e}))}(e,t),r=(null===n||void 0===n?void 0:n.geometry.coordinates)||[0,0];j(e,r,n)}),[j]),A=(0,o.useMemo)((function(){return"idle"!==T&&"loading"!==T}),[T]),I=(0,o.useMemo)((function(){return!!C.length}),[C]);return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(c,{}),(0,u.jsxs)("div",{className:"fr-input-group ".concat(w||""),children:[n&&(0,u.jsx)(l,{centred:E,children:n}),(0,u.jsxs)(i.hQ,{"aria-label":"address","aria-labelledby":"address",className:"fr-input-wrap fr-fi-search-line",onSelect:function(e){return x(e,C)},children:[(0,u.jsx)(d,{onChange:function(e){var t=e.currentTarget.value;S&&S(t),P(t)},placeholder:h}),A&&(0,u.jsx)(i.SF,{className:O,children:I?(0,u.jsx)(f,{suggestions:C}):(0,u.jsx)(s,{children:a})})]})]})]})}},8022:function(e,t,n){n.d(t,{z$:function(){return f},ki:function(){return m},aI:function(){return v}});var r=n(9499),i=n(29),o=n(7794),a=n.n(o);function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var u=function(e,t){if(!e||!t)return!1;var n="".concat(e<=100?"< 100m":e<=200?"> 100m et < 200m":"> 200m",", ").concat(t);return!["< 100m, collectif","< 100m, individuel","> 100m et < 200m, collectif","> 100m et < 200m, individuel","> 200m, collectif","> 200m, individuel"].includes(n)&&n},l=function(e){switch(e){case"\xe9lectricit\xe9":return"\xc9lectricit\xe9";case"gaz":return"Gaz";case"fioul":return"Fioul";default:return"Autre / Je ne sais pas"}},d=function(e){switch(e){case"individuel":return"Individuel";case"collectif":return"Collectif";default:return"Autre / Je ne sais pas"}},f=function(e){var t=e.address,n=e.coords,r=e.eligibility,i=e.heatingEnergy,o=e.heatingType,a=e.network,c=e.structure,s=e.firstName,f=e.lastName,g=e.company,v=e.email,m=e.termOfUse;return{Nom:f,"Pr\xe9nom":s,Structure:c,"\xc9tablissement":g,"\xc9ligibilit\xe9":r,Adresse:t,Latitude:parseFloat(n.lat),Longitude:parseFloat(n.lon),Mail:v,"Mode de chauffage":l(i),"Type de chauffage":d(o),"Distance au r\xe9seau":null===a||void 0===a?void 0:a.distance,"Choix en fonction de la distance au r\xe9seau":u(null===a||void 0===a?void 0:a.distance,o)||"inconnue","J\u2019accepte les CGU":m}},g=function(){var e=(0,i.Z)(a().mark((function e(t,n){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"./api/airtable/create-record",e.abrupt("return",fetch("./api/airtable/create-record",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s(s({},t),{},{type:n}))}));case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),v=g,m=function(e){var t=e.address,n=e.coords,r=e.eligibility,i=e.heatingEnergy,o=e.heatingType,a=e.network,c=e.structure,s=e.firstName,u=e.lastName,l=e.company,d=e.email,f=e.termOfUse;return{Nom:u||"","Pr\xe9nom":s||"","\xc9tablissement":l||"",Email:d||"",Structure:c||"",Chauffage:"".concat(i," - ").concat(o),Adresse:{coords:[n.lat,n.lon],label:t||""},"Distance au r\xe9seau":null!==a&&void 0!==a&&a.distance?"".concat(a.distance,"m"):"inconnue","\xc9ligiblit\xe9":r,"Accord des CGU":f}}},103:function(e,t,n){n.d(t,{qO:function(){return k},Co:function(){return P},V_:function(){return x},rc:function(){return A}});var r=n(6835),i=n(1692),o=n(8022),a=n(3454),c=function(){var e=(0,i.H)({formId:"8ccEEqGt"}),t=(0,r.Z)(e,2),n=t[0];return[function(e){return"true"===a.env.NEXT_PUBLIC_MOCK_USER_CREATION?(console.info("Send following data to Formspark",(0,o.ki)(e)),console.info("Send following data to Airtabe",(0,o.z$)(e)),Promise.resolve([function(){},!0])):Promise.all([n((0,o.ki)(e)),(0,o.aI)((0,o.z$)(e),"FCU - Utilisateurs")])},t[1]]},s=n(9499),u=n(29),l=n(7794),d=n.n(l),f=n(7812),g=(n(5893),function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return"function"===typeof(null===(t=window)||void 0===t?void 0:t.fbq)&&window.fbq(["track"].concat((0,f.Z)(e),(0,f.Z)(n)))}),v=function(e,t){var n,i=(0,r.Z)(t,1)[0];return"function"===typeof(null===(n=window)||void 0===n?void 0:n.gtag)&&window.gtag("event","conversion",{send_to:"AW-".concat(e,"/").concat(i)})},m=function(e){var t,n=(0,r.Z)(e,1)[0];return"function"===typeof(null===(t=window)||void 0===t?void 0:t.lintrk)&&window.lintrk("track",{conversion_id:n})},p=JSON.parse('{"eligibilityTest":{"linkedInEvent":[5492674],"facebookEvent":["FindLocation"],"googleAdsEvent":["7ZZ6CJL-9YIDEMrY_5oo"],"matomoEvent":["Eligibilit\xe9","Formulaire de test - Envoi"]},"eligibilityTestOK":{"linkedInEvent":[5392842],"googleAdsEvent":["xmLwCPqp5P0CEMrY_5oo"],"matomoEvent":["Eligibilit\xe9","Formulaire de test - Adresse \xc9ligible"]},"eligibilityTestKO":{"linkedInEvent":[5492666],"googleAdsEvent":["4BLdCLqy_oIDEMrY_5oo"],"matomoEvent":["Eligibilit\xe9","Formulaire de test - Adresse In\xe9ligible"]},"eligibilityTestUnknow":{"linkedInEvent":[5492682],"googleAdsEvent":["4BLdCLqy_oIDEMrY_5oo"],"matomoEvent":["Eligibilit\xe9","Formulaire de test - Adresse Inconnue"]},"contactFormEligible":{"facebookEvent":["Contact"],"matomoEvent":["Eligibilit\xe9","Formulaire de contact \xe9ligible - Envoi"]},"contactFormIneligible":{"facebookEvent":["Contact"],"matomoEvent":["Eligibilit\xe9","Formulaire de contact in\xe9ligible - Envoi"]}}');function b(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?b(Object(n),!0).forEach((function(t){(0,s.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):b(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var y=function(){var e,t,n,i,o;return null===(e=window)||void 0===e||null===(t=e.tarteaucitron)||void 0===t||null===(n=t.proTemp)||void 0===n||null===(i=n.split("!"))||void 0===i||null===(o=i.reduce((function(e,t){var n=t.split("="),i=(0,r.Z)(n,2),o=i[0],a=i[1];return h(h({},e),{},(0,s.Z)({},o,"false"!==a))}),{}))||void 0===o?void 0:o.matomo},w=function(e){var t,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return"function"===typeof(null===(t=window)||void 0===t||null===(n=t._paq)||void 0===n?void 0:n.push)&&window._paq.push(["trackEvent"].concat((0,f.Z)(e),(0,f.Z)(y()?r:["Consentement non accord\xe9"])))},O=n(7294);function E(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function j(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?E(Object(n),!0).forEach((function(t){(0,s.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):E(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var S=function(e){var t=e.estEligible,n=e.address,r=t?"contactFormEligible":"contactFormIneligible";w(p[r].matomoEvent,[n]),g(p[r].facebookEvent)},k=function(){var e=(0,O.useRef)(null),t=(0,O.useState)({}),n=t[0],i=t[1],o=(0,O.useState)(!1),a=o[0],s=o[1],l=(0,O.useState)(!1),f=l[0],b=l[1],h=(0,O.useState)(!1),y=h[0],E=h[1],k=(0,O.useState)(!1),C=k[0],P=k[1],T=(0,O.useState)("idle"),x=T[0],A=T[1],I=c(),_=(0,r.Z)(I,1)[0],N=(0,O.useCallback)((function(t,n){return window.setTimeout((function(){var t=e.current;null===t||void 0===t||t.scrollIntoView({behavior:"smooth"}),n&&n()}),t)}),[]),F=(0,O.useCallback)((function(e){var t=e.address,n=e.heatingType;i(e),b(t&&!n)}),[]),Z=(0,O.useCallback)((function(e){var t=e.address,r=n.heatingType;A("loading"),E(!1),P(!1),function(e){w(p.eligibilityTest.matomoEvent,[e]),m(p.eligibilityTest.linkedInEvent),g(p.eligibilityTest.facebookEvent),v("10794036298",p.eligibilityTest.googleAdsEvent)}(t),b(t&&!r)}),[n]),D=(0,O.useCallback)((function(e){var t=e.address,n=e.heatingType;if(function(e){var t=e.eligibility,n=e.address;t?(w(p.eligibilityTestOK.matomoEvent,[n||"Adresse indefini"]),m(p.eligibilityTestOK.linkedInEvent),v("10794036298",p.eligibilityTestOK.googleAdsEvent)):(w(p.eligibilityTestKO.matomoEvent,[n||"Adresse indefini"]),m(p.eligibilityTestKO.linkedInEvent),v("10794036298",p.eligibilityTestKO.googleAdsEvent))}({eligibility:e.eligibility,address:t}),i(e),t&&n){s(!0);var r=N(500,(function(){return A("loaded")}));return function(){return window.clearTimeout(r)}}}),[N]),L=(0,O.useCallback)((0,u.Z)(d().mark((function e(){var t,r,o=arguments;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"Tertiaire"!==(t=o.length>0&&void 0!==o[0]?o[0]:{}).structure&&(t.company=""),E(!0),S(t),e.next=6,_(t);case 6:return r=N(500),i(j(j({},n),t)),P(!0),e.abrupt("return",(function(){return window.clearTimeout(r)}));case 10:case"end":return e.stop()}}),e)}))),[n,_,N]);return{EligibilityFormContactRef:e,addressData:n,contactReady:a,showWarning:f,messageSent:y,messageReceived:C,loadingStatus:x,warningMessage:"N'oubliez pas d'indiquer votre type de chauffage.",handleOnChangeAddress:F,handleOnFetchAddress:Z,handleOnSuccessAddress:D,handleOnSubmitContact:L}},C=n(2045),P=function(e){var t=e.id,n=e.name,r=(0,O.useRef)((0,C.Z)());return(0,O.useMemo)((function(){return"".concat(t||n||"id","-").concat(r.current)}),[n,t])},T="__FCU:App__";var x=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.beforeStorage,i=void 0===r?function(){}:r,o=n.keyPrefix,a=void 0===o?T:o,c=(0,O.useState)(t),s=c[0],u=c[1],l=(0,O.useMemo)((function(){return"".concat(a,"-").concat(e)}),[a,e]),d=(0,O.useRef)(l),f=(0,O.useCallback)((function(e,t){return window.localStorage.setItem(e,JSON.stringify(i(t)))}),[i]);return(0,O.useEffect)((function(){try{var e=window.localStorage.getItem(l);null!==e&&u(JSON.parse(e))}catch(t){console.error(t)}}),[l]),(0,O.useEffect)((function(){try{f(d.current,s)}catch(e){console.error(e)}}),[f,s]),(0,O.useEffect)((function(){var e=d.current;if(l!==e)try{f(l,s),d.current=l,window.localStorage.removeItem(e)}catch(t){console.error(t)}}),[l,f,s]),[s,u]};var A=function(e){var t=(0,O.useRef)();return(0,O.useEffect)((function(){t.current=e}),[e]),t.current}}}]);