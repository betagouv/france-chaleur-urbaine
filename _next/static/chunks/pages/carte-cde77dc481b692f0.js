(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[150],{6793:function(e,r,o){"use strict";o.r(r),o.d(r,{default:function(){return er}});var t=o(9499),n=o(4730),a=o(6835),i=o(7812),l=o(2524),c=o(4613),s=o.n(c),d=(o(5616),o(1163)),u=o(7294),p=o(5387),g=o(2125),m="#18753c",f="#b8fec9",b="#ce0500",h="#ffe9e9",y="#000",v="#ccc",x=(0,g.iv)(["max-height:calc( 100vh - "," - "," - 5rem - 4rem );"],p.YG,p.Ji),w=g.ZP.div.withConfig({displayName:"CardDetailsstyle__MapCard",componentId:"sc-m08mvi-0"})(["width:100%;display:block;background-color:white;margin:1em 0;border:2px solid var(--bf500);border:1px solid rgb(0 0 0 / 20%);border-radius:0.3em;overflow:hidden;box-shadow:1px 0 4px 1px rgb(0 0 0 / 20%);> header{display:flex;justify-content:space-between;padding:0.5em;cursor:",";font-weight:bold;.buttonsWrapper{flex:1;display:flex;justify-content:flex-end;align-items:flex-start;padding-left:0.5rem;.closeButton{position:relative;display:flex;justify-content:center;align-items:center;background-color:#ffffff;box-shadow:0 1px 2px 1px #33333333;width:1.25rem;height:1.25rem;border-radius:50%;cursor:pointer;::before,::after{content:'';position:absolute;width:2px;height:80%;background-color:#333;}::before{content:'';transform:rotate(-45deg);}::after{content:'';transform:rotate(45deg);}}}}&.eligible{border:2px solid ",";> header{background-color:",";color:",";}}&.ineligible{border:2px solid ",";> header{background-color:",";color:",";}}&.energyCard{border:2px solid ",";> header{background-color:",";color:",";}}&.gasUsageCard{border:2px solid ",";> header{background-color:",";color:",";}}&.legendCard{border:2px solid #4550e5;> header{background-color:#4550e5;color:#ffffff;}}section{padding:0.5em;overflow:auto;scrollbar-gutter:stable both-edges;"," transition:max-height 0.75s ease,padding 0.5s ease 0.25s;}&.close{section{max-height:0;padding:0 0.5em;}}"],(function(e){return e.isClickable?"pointer":"default"}),f,f,m,h,h,b,h,h,b,v,v,y,x),j=g.ZP.div.withConfig({displayName:"CardDetailsstyle__EligibilityResult",componentId:"sc-m08mvi-1"})(["background-color:#eeeeee;padding:0.5em;margin-bottom:0.5em;border-left:2px solid;",""],(function(e){var r=e.isEligible;return(0,g.iv)(["border-color:","",";"],r?m:b,"a6")})),k=(g.ZP.div.withConfig({displayName:"CardDetailsstyle__EnergyResult",componentId:"sc-m08mvi-2"})(["padding:0.5em;margin-bottom:0.5em;border-left:2px solid;border-color:#c72e6e;"]),g.ZP.div.withConfig({displayName:"CardDetailsstyle__GasUsageResult",componentId:"sc-m08mvi-3"})(["padding:0.5em;margin-bottom:0.5em;border-left:2px solid;border-color:#136ce0;"]),o(5893)),O=function(e){var r,o,t,n=e.result,a=e.onClick,i=e.onClickClose,l=((null===(r=n.addressDetails)||void 0===r||null===(o=r.networkDetails)||void 0===o?void 0:o.network)||{}).distance,c=((null===(t=n.addressDetails)||void 0===t?void 0:t.networkDetails)||{}).isEligible;return(0,k.jsxs)(w,{isEligible:c,typeCard:"search",onClick:function(e){var r="function"===typeof a&&a(n)||void 0;return e.stopPropagation(),r},className:c?"eligible":"ineligible",isClickable:!0,children:[(0,k.jsxs)("header",{children:[n.address,(0,k.jsx)("div",{className:"buttonsWrapper",children:i&&(0,k.jsx)("div",{className:"closeButton",onClick:function(){i&&i(n)}})})]}),(0,k.jsxs)("section",{children:[(0,k.jsx)(j,{isEligible:c,children:c?"Bonne nouvelle ! Un r\xe9seau de chaleur passe \xe0 proximit\xe9 de cette adresse.":"Cette adresse n'est pour le moment pas raccordable \xe0 un r\xe9seau de chaleur."}),(0,k.jsx)("div",{children:!isNaN(l)&&"Distance au r\xe9seau ".concat(l<1?"< 1m":l>=1e3?": ".concat(l/1e3,"km"):": ".concat(l,"m"))})]})]})},C=o(4041),_=g.ZP.div.withConfig({displayName:"LegendEntrystyled__LabelLegendWrapper",componentId:"sc-l6tz2c-0"})(["font-size:0.95em;display:flex;align-items:baseline;label{display:flex;flex-direction:row;align-items:baseline;}"]),z=g.ZP.div.withConfig({displayName:"LegendEntrystyled__LabelLegend",componentId:"sc-l6tz2c-1"})(["display:inline-flex;flex-direction:column;align-items:flex-start;justify-content:flex-start;"]),P=g.ZP.div.withConfig({displayName:"LegendEntrystyled__LabelLegendMarker",componentId:"sc-l6tz2c-2"})(["width:0rem;height:1rem;display:inline-flex;vertical-align:text-bottom;justify-content:center;align-items:center;margin:0 0.2em;top:-0.15em;position:relative;::before{content:'';display:block;height:1rem;}",""],(function(e){var r=e.bgColor;return r&&(0,g.iv)(["::before{background-color:",";}"],r)})),L=g.ZP.div.withConfig({displayName:"LegendEntrystyled__LabelLegendHead",componentId:"sc-l6tz2c-3"})(["",""],(function(e){return"group"===e.type&&(0,g.iv)(["font-weight:bold;border-bottom:1px solid;margin-bottom:0.2em;line-height:1.45;"])})),Z=g.ZP.div.withConfig({displayName:"LegendEntrystyled__LabelLegendDescription",componentId:"sc-l6tz2c-4"})(["font-size:0.73em;line-height:1.2;color:#8d93a1;"]);var N=function(e){var r=e.id,o=e.bgColor,t=e.className,n=e.type,a=e.label,i=e.description,l=e.checked,c=e.readOnly,s=e.onChange;return(0,k.jsx)("div",{children:(0,k.jsx)(_,{children:(0,k.jsxs)("label",{children:[(0,k.jsx)("input",{type:"checkbox",checked:l,onChange:function(){!c&&s(r)}}),(0,k.jsx)(P,{className:"legend-marker ".concat(t?"".concat(t,"-marker"):""),bgColor:o&&"".concat(o)}),(0,k.jsxs)(z,{children:[(0,k.jsx)(L,{type:n,children:a}),i&&(0,k.jsx)(Z,{children:i})]})]})})})},D=o(9720),S={fuelOil:"Copropri\xe9t\xe9s chauff\xe9es au fioul collectif",gas:"Copropri\xe9t\xe9s chauff\xe9es au gaz collectif",wood:"Bois",electric:"Electrique",unknow:"Autre"},E={fuelOil:{color:"#F07300"},gas:{color:"#B414FF"},wood:{color:"#955e15"},electric:{color:"#4cd362"},unknow:{color:"#818181"}},I={T:"Tertiaire",R:"Logements (tous types)",unknow:"Inconnu"},U={T:{color:"#0032E5"},R:{color:"#00B8F0"},unknow:{color:"#818181"}},G={color:"#6DD627"},R={color:"#ff00d4"},F={color:"#ff6600"},M=g.ZP.div.withConfig({displayName:"ScaleLegendstyle__ScaleLegendWrapper",componentId:"sc-1i5z491-0"})(["padding:0 0 0.4rem 0;",""],(function(e){return e.framed&&(0,g.iv)(["padding:0.3em 0.5em 0.55em;margin:0.2em 0.5em 0.4em 1.5em;border:1px solid #d2d6df;border-radius:0.5em;"])})),T=g.ZP.div.withConfig({displayName:"ScaleLegendstyle__ScaleLegendHeader",componentId:"sc-1i5z491-1"})(["font-size:0.8em;margin-bottom:0.2em;"]),A=g.ZP.label.withConfig({displayName:"ScaleLegendstyle__ScaleLegendLabel",componentId:"sc-1i5z491-2"})(["display:inline-block;margin-bottom:0.2em;"]),W=g.ZP.input.withConfig({displayName:"ScaleLegendstyle__Input",componentId:"sc-1i5z491-3"})([""]),Y=g.ZP.div.withConfig({displayName:"ScaleLegendstyle__ScaleLegendBody",componentId:"sc-1i5z491-4"})(["display:flex;justify-content:space-between;",""],(function(e){return e.checkbox&&(0,g.iv)(["padding:0 0.3em;"])})),B=g.ZP.div.withConfig({displayName:"ScaleLegendstyle__ScaleLegendLabelWrapper",componentId:"sc-1i5z491-5"})(["font-size:0.75em;white-space:nowrap;display:inline;position:relative;padding-right:0.5em;&:not(:last-child){margin-right:0.5em;}"]),X=g.ZP.span.withConfig({displayName:"ScaleLegendstyle__ScaleLabelLegend",componentId:"sc-1i5z491-6"})(["width:",";height:1em;display:inline-flex;vertical-align:middle;justify-content:center;align-items:center;margin-right:0.2em;::before{content:'';display:block;position:relative;width:",";height:",";background-color:",";","}"],(function(e){var r=e.size;return"".concat(r,"rem")}),(function(e){var r=e.size;return"".concat(r,"em")}),(function(e){var r=e.size;return"".concat(r,"em")}),(function(e){return e.bgColor||"grey"}),(function(e){return e.circle&&(0,g.iv)(["border-radius:50%;"])})),J=function(e){var r=e.label,o=e.checkbox,t=e.checked,n=e.framed,a=e.onChange,i=e.color,l=e.scaleLabels,c=e.circle;return(0,k.jsxs)(M,{framed:n,children:[o?(0,k.jsxs)(A,{children:[(0,k.jsx)(W,{type:"checkbox",checked:t,onChange:a}),r]}):(0,k.jsx)(T,{children:r}),(0,k.jsx)(Y,{checkbox:o,children:l.map((function(e){var r=e.bgColor,o=e.label,t=e.size;return(0,k.jsxs)(B,{children:[(0,k.jsx)(X,{bgColor:r||i,size:t,circle:c}),o]},o)}))})]})},q={Energy:function(){return(0,k.jsx)(J,{framed:!0,label:"Nombre de lots d'habitation",color:E.gas.color,scaleLabels:[{label:"<\xa0100",size:.5},{label:"100\xa0\xe0\xa01000",size:1},{label:">\xa01000",size:2}]})},EnergyGas:function(){return(0,k.jsx)(J,{framed:!0,label:"Nombre de lots d'habitation",color:"".concat(E.gas.color,"88"),scaleLabels:[{label:"<\xa0100",size:.8},{label:"100\xa0\xe0\xa01000",size:1.3},{label:">\xa01000",size:2}]})},EnergyFuel:function(){return(0,k.jsx)(J,{framed:!0,label:"Nombre de lots d'habitation",color:"".concat(E.fuelOil.color,"88"),scaleLabels:[{label:"<\xa0100",size:.8},{label:"100\xa0\xe0\xa01000",size:1.3},{label:">\xa01000",size:2}]})},GasUsage:function(){return(0,k.jsx)(J,{framed:!0,circle:!0,label:"Niveau de consomation de gaz (MWh)",color:"#D9D9D9",scaleLabels:[{label:"<\xa0100",size:.8},{label:"100\xa0\xe0\xa01000",size:1.3},{label:">\xa01000",size:2}]})}},H=(0,g.vJ)([".legend-label-description{font-size:15px;font-size:0.95em;em{display:block;line-height:1.2;font-size:11px;font-size:0.7em;color:#8D93A1}}"]),V=g.ZP.div.withConfig({displayName:"LegendGroupLabelstyled__GroupeLabelWrapper",componentId:"sc-1uvbh00-0"})(["padding-bottom:0.15em;transition:opacity 0.25s ease-in-out;"," &:last-child{padding-bottom:0;}header{font-weight:bold;margin-bottom:0.2em;font-size:1.15em;}.groupe-label-body{display:flex;flex-wrap:wrap;gap:8px;padding:0 0 0.4rem 0;&.subGroup{margin-left:1.5em;}.label-item{flex:1;min-width:30%;max-width:100%;display:flex;text-align:left;justify-content:flex-start;label{display:inline;white-space:nowrap;&::before{width:0.7em;}}}}"],(function(e){return e.disable&&(0,g.iv)(["opacity:0.3;"])}));function K(e,r){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);r&&(t=t.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),o.push.apply(o,t)}return o}var Q=function(e){var r,o=e.id,n=e.title,a=e.description,i=e.subLegend,l=e.entries,c=e.subGroup,s=e.layerDisplay,d=e.linkto,p=e.onChangeEntry,g=(0,u.useMemo)((function(){return null===d||void 0===d?void 0:d.map((function(e){return null===s||void 0===s?void 0:s[e]})).some((function(e){return!1===e}))}),[s,d]);return(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(H,{}),(0,k.jsxs)(V,{disable:g,children:[n&&(0,k.jsx)("header",{children:n}),a&&(0,k.jsx)(D.Z,{className:"legend-label-description",value:a}),(0,k.jsx)("div",{className:"groupe-label-body ".concat(c?"subGroup":""),children:l.map((function(e){var r;return(0,k.jsx)(N,function(e){for(var r=1;r<arguments.length;r++){var o=null!=arguments[r]?arguments[r]:{};r%2?K(Object(o),!0).forEach((function(r){(0,t.Z)(e,r,o[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):K(Object(o)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(o,r))}))}return e}({checked:(null===s||void 0===s?void 0:s[o])instanceof Array?null===s||void 0===s||null===(r=s[o])||void 0===r?void 0:r.includes(e.id):null===s||void 0===s?void 0:s[o],type:c?"subGroup":"group",onChange:function(){return p(o,null===e||void 0===e?void 0:e.id)},readOnly:g},e),e.id)}))}),i&&(null===q||void 0===q||null===(r=q[i])||void 0===r?void 0:r.call(q))]})]})},$=((0,g.vJ)([".leaflet-container .leaflet-control-attribution{margin:0.5em 0;padding:0 0.5em;background:rgba(255,255,255,0.85);font-weight:bold;padding-left:3rem;position:relative;}.leaflet-control-attribution{position:relative;border-radius:1em 0 0 1em;overflow:hidden;cursor:default;transform:translateX(calc(100% - 3em));transition:transform 0.4s ease;&::before{content:'\xa9';position:absolute;left:0;height:100%;display:inline-flex;align-items:center;justify-content:center;width:3rem;padding-left:1.25em;padding-right:0.5em;margin-right:0.5em;margin-left:-0.5em;border-right:1px solid #fff;background-color:#4550e5;color:#fff;font-weight:bold;cursor:pointer;}&::after{content:'';position:absolute;left:0;top:50%;width:0em;height:0em;border:0 none transparent;border-left:0.5em solid transparent;border-right:0.5em solid transparent;border-bottom:0.5em solid #fff;transform:translateY(calc(-50% - .05em)) rotate(-90deg) translateY(.45em);transition:transform 0.5s ease;}&:hover{transform:translateX(0);&::after{transform:translateY(calc(-50% - .05em)) rotate(90deg) translateY(-.45em);}}a[target]{color:#4550e5;&::after{content:'';}}}.my-div-icon{position:relative;i{position:relative;display:block;transform-origin:bottom;::before{content:\"\";display:block;position:absolute;bottom:0;left:0;width:2.5rem;height:2.5rem;background-color:#4550e5;border:2px solid white;border-radius:50% 45% 75% 0% / 75% 45% 50% 0%;transform-origin:bottom left;transform:translateX(6px) translateY(-3px) rotate(-45deg);box-shadow:-3px 3px 4px 3px rgb(0 0 0 / 35%)}::after{content:\"\";display:block;position:absolute;top:0;left:0;width:1.3rem;height:1.3rem;border:5px double white;border-radius:50%;transform:translateX(6px) translateY(-3px) translateX(-.65rem) translateY(-.65rem) translateY(-1.8rem);}}}.pan-map-aside{width:100%;}"]),(0,g.vJ)(["hr{border:1px solid #4550e5;border-width:0 0 1px;margin:.75em 1.25em;height:0;}.legend-heat-network-marker{width:1.5rem;:before{width:100%;height:0;border:3px solid ",";border-radius:3px;margin-bottom:calc(0.25em - 1.5px)}}.legend-boiler-room-marker{width:1.5rem;:before{width:100%;border:3px solid ",";border-radius:3px;background-color:",";margin-bottom:calc(0.25em - 1.5px)}}.legend-substation-marker{width:1.5rem;:before{width:1rem;border:3px solid ",";border-radius:50%;background-color:",";margin-bottom:calc(0.25em - 1.5px)}}.legend-energy-marker{width:.6rem;::before{width:0.5rem;height:0.5rem;border-radius:50%;margin-bottom:calc(0.25em - 1.5px)}}"],G.color,F.color,F.color,R.color,R.color));function ee(e,r){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);r&&(t=t.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),o.push.apply(o,t)}return o}var re=function(e){var r=e.data,o=e.hasResults,n=e.layerDisplay,a=e.onToogleFeature,i=e.onToogleInGroup,l=(0,u.useState)(!1),c=l[0],s=l[1];return(0,k.jsxs)(w,{typeCard:"legend",isClickable:o,className:"legendCard ".concat(!c&&o?"close":""),children:[(0,k.jsx)($,{}),(0,k.jsxs)("header",{onClick:function(){o&&s(!c)},children:["L\xe9gende",o&&(0,k.jsx)(C.Icon,{name:c?"ri-arrow-down-s-line":"ri-arrow-up-s-line"})]}),(0,k.jsx)("section",{children:r.map((function(e,r){if("separator"===e)return(0,k.jsx)("hr",{},"separator-".concat(r));if("object"!==typeof e)return null;var o=e.id,l=e.title,c=e.description,s=e.subGroup,d=e.entries,u=e.subLegend,p=e.linkto,g=e.type,m=void 0===g?"list":g;return"group"===m?(0,k.jsx)(Q,{layerDisplay:n,id:o,title:l,subLegend:u,description:c,subGroup:s,entries:d,linkto:p,onChangeEntry:i},"group-".concat(o,"-").concat(r)):"list"===m?d.map((function(e){return(0,k.jsx)(N,function(e){for(var r=1;r<arguments.length;r++){var o=null!=arguments[r]?arguments[r]:{};r%2?ee(Object(o),!0).forEach((function(r){(0,t.Z)(e,r,o[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):ee(Object(o)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(o,r))}))}return e}({checked:!(null===n||void 0===n||!n[e.id]),onChange:a},e),e.id)})):void 0}))})]})},oe=o(29),te=o(7794),ne=o.n(te),ae=o(3901),ie=o(4438),le=(0,g.vJ)([".map-search-form{width:100%;}.popover-map-search-form{z-index:1000;}"]),ce=function(e){var r=e.onAddressSelect,o=(0,ie.Su)().heatNetworkService,t=function(){var e=(0,oe.Z)(ne().mark((function e(t,n){var i,l,c,s,d,u;return ne().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=(0,a.Z)(n,2),l=i[0],c=i[1],s={lat:c,lon:l},e.next=4,o.findByCoords(s);case 4:d=e.sent,u={networkDetails:d},r&&r(t,[c,l],u);case 7:case"end":return e.stop()}}),e)})));return function(r,o){return e.apply(this,arguments)}}();return(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(le,{}),(0,k.jsx)(ae.Z,{placeholder:"Rechercher une adresse",onAddressSelected:t,className:"map-search-form",popoverClassName:"popover-map-search-form"})]})};function se(e,r){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);r&&(t=t.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),o.push.apply(o,t)}return o}function de(e){for(var r=1;r<arguments.length;r++){var o=null!=arguments[r]?arguments[r]:{};r%2?se(Object(o),!0).forEach((function(r){(0,t.Z)(e,r,o[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):se(Object(o)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(o,r))}))}return e}var ue=function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=r.className,t=r.bodyFormater,n=(0,u.useRef)([]),l=(0,u.useRef)(new(s().Popup)({className:o})),c=(0,u.useState)([]),d=c[0],p=c[1],g=(0,u.useCallback)((function(e,r){var o,t=r.energy,l=r.consommation,c=(0,a.Z)(e,2),s=c[0],d=c[1],u="".concat(s.toFixed(4),"--").concat(d.toFixed(4)),g=function(e){return e.id===u};n.current=[].concat((0,i.Z)(n.current.filter((o=g,function(){return!o.apply(void 0,arguments)}))),[de(de(de({},n.current.find(g)||{}),{},{id:u,coordinates:e},t?{energy:t}:{}),l?{consommation:l}:{})]),p(n.current)}),[]),m=(0,u.useCallback)((function(r){var o=r.coordinates,n=t?t(r):JSON.stringify(r);l.current.setLngLat(o).setHTML(n).addTo(e)}),[t,e]);return(0,u.useEffect)((function(){var e=d[d.length-1];e&&m(e)}),[d,m]),[l.current,d,g]},pe=[48.85294,2.34987],ge={outline:!0,substation:!1,boilerRoom:!1,gasUsageGroup:!0,gasUsage:["R","T"],energy:["fuelOil","gas"]},me=[{id:"heat-network",entries:[{id:"outline",label:"R\xe9seaux de chaleur",className:"legend-heat-network"}],type:"list"},"separator",{id:"gasUsageGroup",title:"Gaz :",entries:[{id:"gasUsageGroup",label:"Consommations de gaz",description:"Source : Donn\xe9es locales de l\u2019\xe9nergie, MTE",bgColor:"red"}],type:"group"},{id:"gasUsage",entries:ge.gasUsage.map((function(e){return{id:e,label:(null===I||void 0===I?void 0:I[e])||I.unknow,bgColor:U[e].color,className:"legend-energy"}})),subLegend:"GasUsage",type:"group",subGroup:!0,linkto:["gasUsageGroup"]},{id:"energy",entries:[{id:"gas",label:(null===S||void 0===S?void 0:S.gas)||S.unknow,description:"Source : Registre national des copropri\xe9t\xe9s",bgColor:E.gas.color}],subLegend:"EnergyGas",type:"group"},"separator",{id:"energy",title:"Fioul :",entries:[{id:"fuelOil",label:(null===S||void 0===S?void 0:S.fuelOil)||S.unknow,description:"Source : Registre national des copropri\xe9t\xe9s",bgColor:E.fuelOil.color}],subLegend:"EnergyFuel",type:"group"}],fe={minZoomData:12.75,minZoom:4,maxZoom:22,defaultZoom:12,lng:pe[1],lat:pe[0],defaultLayerDisplay:ge,legendData:me};function be(e,r){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);r&&(t=t.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),o.push.apply(o,t)}return o}function he(e){for(var r=1;r<arguments.length;r++){var o=null!=arguments[r]?arguments[r]:{};r%2?be(Object(o),!0).forEach((function(r){(0,t.Z)(e,r,o[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):be(Object(o)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(o,r))}))}return e}var ye=fe.minZoomData,ve=fe.maxZoom,xe=(0,g.vJ)([".map-wrap{position:relative;width:100%;height:100%;}.map{position:absolute;width:100%;height:100%;}.maplibregl-control-container,.mapboxgl-control-container{> [class*=mapboxgl-]{z-index:",";}}.maplibregl-marker,.mapboxgl-marker{z-index:",";}.popover-map-search-form{z-index:"," !important;}.popup-map-layer{z-index:10000;font-size:.8rem;&.maplibregl-popup-anchor-left  .maplibregl-popup-tip{border-right-color:#4550e5;}&.maplibregl-popup-anchor-right  .maplibregl-popup-tip{border-left-color:#4550e5;}&.maplibregl-popup-anchor-top  .maplibregl-popup-tip{border-bottom-color:#4550e5;}&.maplibregl-popup-anchor-bottom  .maplibregl-popup-tip{border-top-color:#4550e5;}.maplibregl-popup-content{border:2px solid #4550e5;border-radius:0.3em;overflow:hidden;header{padding:7px 25px 7px 10px;margin:-15px -10px 10px;background-color:#4550e5;color:#fff;h6{font-size:1.45em;font-weight:bold;margin:0;}em.coord{font-size:0.85em;}}.maplibregl-popup-close-button{font-size:1.5em;line-height:0;font-weight:bold;color:#fff;display:flex;align-items:center;justify-content:center;width:1.25em;height:1.25em;padding:0 0 2px;margin:3px;border-radius:1em;transition-property:color,background-color;transition-duration:0.25s;transition-timing-function:ease;&:hover{color:#4550e5;background-color:#fff;}}}}"],1e4,1e4,10101),we="15px",je=g.ZP.div.withConfig({displayName:"Mapstyle__MapControlWrapper",componentId:"sc-v57w17-0"})(["position:absolute;z-index:",";max-width:430px;width:100%;min-width:330px;padding:1rem;"," "," &.search-result-box{max-height:100%;overflow:auto;overflow-y:auto;overflow-y:overlay;overflow-x:visible;padding-bottom:6rem;mask-image:linear-gradient(180deg,transparent 0,black 0%),linear-gradient( 180deg,rgba(0,0,0,0.3) 0,black ",",black calc(100% - ","),transparent 100% );mask-size:",",calc(100% - ",");mask-repeat:no-repeat,no-repeat;mask-position:right top,left top;}"],10100,(function(e){return e.bottom?(0,g.iv)(["bottom:0;"]):(0,g.iv)(["top:0;"])}),(function(e){return e.right?(0,g.iv)(["right:0;"]):(0,g.iv)(["left:0;"])}),"3.5rem","7rem",we,we),ke=g.ZP.div.withConfig({displayName:"Mapstyle__MapSearchResult",componentId:"sc-v57w17-1"})(["padding-top:3rem;"]),Oe={type:"line",layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":G.color,"line-width":3,"line-opacity":["interpolate",["linear"],["zoom"],11,.75,15,1]}},Ce={type:"fill",layout:{},paint:{"fill-color":R.color,"fill-opacity":1}},_e={type:"fill",layout:{},paint:{"fill-color":F.color,"fill-outline-color":F.color,"fill-opacity":["interpolate",["linear"],["zoom"],11,.75,15,.95]}},ze="nb_lot_habitation_bureau_commerce",Pe=Object.entries({fioul:"fuelOil",fioul_domestique:"fuelOil",gaz:"gas",gaz_naturel:"gas",gaz_collectif:"gas",gaz_propane_butane:"gas",charbon:"wood",bois_de_chauffage:"wood",electricite:"electric",energie_autre:"unknow","sans objet":"unknow",default:"unknow"}).reduce((function(e,r){var o=(0,a.Z)(r,2),n=o[0],l=o[1];return he(he({},e),{},(0,t.Z)({},l,[].concat((0,i.Z)(e[l]||[]),[n])))}),{}),Le=[].concat((0,i.Z)(Object.entries(E).flatMap((function(e){var r=(0,a.Z)(e,2),o=r[0],t=r[1];return[Pe[o],t.color]}))),[E.unknow.color]),Ze={type:"symbol",layout:{"icon-image":"energy-picto","symbol-sort-key":["-",["coalesce",["get",ze],0]],"icon-size":["interpolate",["linear"],["zoom"],ye+.1,["case",["<",["get",ze],100],.25,["<",["get",ze],1e3],.6,1],ve,["case",["<",["get",ze],100],.5,["<",["get",ze],1e3],1.2,2]]},paint:{"icon-color":["match",["get","energie_utilisee"]].concat((0,i.Z)(Le)),"icon-opacity":["interpolate",["linear"],["zoom"],ye+.2,0,ye+.5+1,.65]}},Ne="conso",De=[].concat((0,i.Z)(Object.entries(U).flatMap((function(e){var r=(0,a.Z)(e,2);return[r[0],r[1].color]}))),[U.unknow.color]),Se={type:"circle",layout:{"circle-sort-key":["-",["coalesce",["get",Ne],0]]},paint:{"circle-color":["match",["get","code_grand_secteur"]].concat((0,i.Z)(De)),"circle-radius":["interpolate",["linear"],["zoom"],ye+.1,["case",["<",["get",Ne],100],4,["<",["get",Ne],1e3],8,14],ve,["case",["<",["get",Ne],100],8,["<",["get",Ne],1e3],16,28]],"circle-opacity":["interpolate",["linear"],["zoom"],ye+.2,0,ye+.2+1,.35],"circle-stroke-opacity":0}},Ee=o(3454),Ie=["marker"];function Ue(e,r){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);r&&(t=t.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),o.push.apply(o,t)}return o}function Ge(e){for(var r=1;r<arguments.length;r++){var o=null!=arguments[r]?arguments[r]:{};r%2?Ue(Object(o),!0).forEach((function(r){(0,t.Z)(e,r,o[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):Ue(Object(o)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(o,r))}))}return e}var Re=fe.defaultZoom,Fe=fe.maxZoom,Me=fe.minZoom,Te=fe.minZoomData,Ae=fe.lng,We=fe.lat,Ye=fe.defaultLayerDisplay,Be=fe.legendData,Xe=["outline","substation","boilerRoom"],Je=function(e){return"".concat(e.join("--"))},qe=function(e){var r,o,t=e.coordinates,n=e.consommation,a=e.energy,l=null!==(r=null!==(o=null===n||void 0===n?void 0:n.result_label)&&void 0!==o?o:null===a||void 0===a?void 0:a.adresse_reference)&&void 0!==r?r:null,c=function(e){return e&&e.replace(/_/g," ").toLowerCase()},s=a||{},d=s.nb_lot_habitation_bureau_commerce,u=s.energie_utilisee,p=s.periode_construction,g=n||{},m=g.code_grand_secteur,f=g.conso;return"\n    ".concat(l?"\n          <header>\n            <h6>".concat(l,'</h6>\n            <em class="coord">Lat, Lon : ').concat((0,i.Z)(t).reverse().map((function(e){return e.toFixed(5)})).join(","),"</em>\n          </header>"):"","\n    ","\n        <section>\n          ".concat(m?"<strong>".concat(function(e){switch(e){case"R":return"Logement residentiel";case"T":return"\xc9tablissement tertiaire"}return""}(m),"</strong><br />"):a?"<strong>Copropri\xe9t\xe9</strong><br />":"","\n          ").concat(d?"Nombre de lots : ".concat(d,"<br />"):"","\n          ").concat(u?"Chauffage actuel :  ".concat(c(u),"<br />"):"","\n          ").concat(f&&(!u||null!==Pe&&void 0!==Pe&&Pe.gas.includes(u))?"Consommations de gaz :  ".concat(null===f||void 0===f?void 0:f.toFixed(2),"&nbsp;MWh<br />"):"","\n          ").concat(p?"P\xe9riode de construction : ".concat(c(p),"<br />"):"","\n        </section>\n      "),"\n  ")};function He(){var e=(0,u.useRef)(null),r=(0,u.useRef)(null),o=(0,u.useState)("pending"),c=o[0],p=o[1],g=(0,u.useState)(Ye),m=g[0],f=g[1],b=(0,l.V_)("mapSoughtAddress",[],{beforeStorage:function(e){return e.map((function(e){e.marker;return(0,n.Z)(e,Ie)}))}}),h=(0,a.Z)(b,2),y=h[0],v=h[1],x=(0,d.useRouter)().query,w=ue(r.current,{bodyFormater:qe,className:"popup-map-layer"}),j=(0,a.Z)(w,3)[2],C=(0,u.useCallback)((function(e){var o=e.coordinates;r.current.flyTo({center:{lon:o[0],lat:o[1]},zoom:16})}),[]),_=(0,u.useCallback)((function(){console.info("State of: soughtAddress =>",y)}),[y]),z=(0,u.useCallback)((function(e,r,o){var t=[r[1],r[0]],n={date:Date.now()},a=Je(t);if(Array.isArray(y)){var l=y.find((function(e){return e.id===a}))||{id:a,coordinates:t,address:e,addressDetails:o,search:n};v([].concat((0,i.Z)(y.filter((function(e){var r=e.id;return"".concat(r)!==a}))),[l])),C({coordinates:t})}}),[C,v,y]),P=(0,u.useCallback)((function(e){var r;if(e.coordinates){var o=Je(e.coordinates),t=y.filter((function(e){var r=e.coordinates;return Je(r)!==o}));null===e||void 0===e||null===(r=e.marker)||void 0===r||r.remove(),v(t)}}),[v,y]),L=(0,u.useCallback)((function(e){var r;f(Ge(Ge({},m),{},(0,t.Z)({},e,null!==(r=!(null!==m&&void 0!==m&&m[e]))&&void 0!==r&&r)))}),[m]),Z=(0,u.useCallback)((function(e){var r=new Set(m.energy);r.has(e)?r.delete(e):r.add(e),f(Ge(Ge({},m),{},{energy:Array.from(r)}))}),[m]),N=(0,u.useCallback)((function(e){var r=new Set(m.gasUsage);r.has(e)?r.delete(e):r.add(e),f(Ge(Ge({},m),{},{gasUsage:Array.from(r)}))}),[m]),D=(0,u.useCallback)((function(){f(Ge(Ge({},m),{},{gasUsageGroup:!m.gasUsageGroup}))}),[m]);(0,u.useEffect)((function(){"loaded"===c||r.current||(r.current=new(s().Map)({attributionControl:!1,container:e.current,style:"https://openmaptiles.geo.data.gouv.fr/styles/osm-bright/style.json",center:[Ae,We],zoom:Re,maxZoom:Fe,minZoom:Me}),r.current.on("click",(function(){console.info("zoom =>",r.current.getZoom()),_()})),r.current.on("load",(function(){r.current.loadImage("./icons/rect.png",(function(e,o){var t;if(e)throw e;p("loaded"),r.current.addImage("energy-picto",o,{sdf:!0});var n=new(s().NavigationControl)({showCompass:!0,showZoom:!0,visualizePitch:!0});r.current.addControl(n,"top-left");var a=new(s().AttributionControl)({compact:!1});r.current.addControl(a,"bottom-right");var i=new(s().ScaleControl)({maxWidth:100,unit:"metric"});r.current.addControl(i,"bottom-left");var l=null!==(t=Ee.env.NEXT_PUBLIC_MAP_ORIGIN)&&void 0!==t?t:document.location.origin;r.current.addSource("heatNetwork",{type:"vector",tiles:["".concat(l,"/api/map/network/{z}/{x}/{y}")]}),r.current.addLayer(Ge({id:"outline",source:"heatNetwork","source-layer":"outline"},Oe)),r.current.addLayer(Ge({id:"substation",source:"heatNetwork","source-layer":"substation"},Ce)),r.current.addLayer(Ge({id:"boilerRoom",source:"heatNetwork","source-layer":"boilerRoom"},_e)),r.current.addSource("energy",{type:"vector",tiles:["".concat(l,"/api/map/energy/{z}/{x}/{y}")],maxzoom:Fe,minzoom:Te}),r.current.addLayer(Ge({id:"energy",source:"energy","source-layer":"condominiumRegister"},Ze)),r.current.on("click","energy",(function(e){var r=e.features[0].properties,o=e.features[0].geometry.coordinates.slice();j(o,{energy:r})})),r.current.on("mouseenter","energy",(function(){r.current.getCanvas().style.cursor="pointer"})),r.current.on("mouseleave","energy",(function(){r.current.getCanvas().style.cursor=""})),r.current.addSource("gasUsage",{type:"vector",tiles:["".concat(l,"/api/map/gas/{z}/{x}/{y}")],maxzoom:Fe,minzoom:Te}),r.current.addLayer(Ge({id:"gasUsage",source:"gasUsage","source-layer":"gasUsage"},Se)),r.current.on("click","gasUsage",(function(e){var r=e.features[0].properties,o=e.features[0].geometry.coordinates.slice();j(o,{consommation:r})})),r.current.on("mouseenter","gasUsage",(function(){r.current.getCanvas().style.cursor="pointer"})),r.current.on("mouseleave","gasUsage",(function(){r.current.getCanvas().style.cursor=""}))}))})))}));var S=(0,u.useState)({}),E=S[0],I=S[1];return(0,u.useEffect)((function(){var e=E.coord,o=x.coord;if(o&&o!==e){var t="string"===typeof o?o.split(",").map((function(e){return parseFloat(e)})).reverse():o;C({coordinates:t}),I(x),new(s().Marker)({color:"#ea7c3f"}).setLngLat(t).addTo(r.current)}}),[C,x,E]),(0,u.useEffect)((function(){var e=!1,o=y.map((function(o){if(o.marker)return o;var t=new(s().Marker)({color:"#4550e5"}).setLngLat(o.coordinates).addTo(r.current);return e=!0,Ge({marker:t},o)}));e&&v(o)}),[v,y]),(0,u.useEffect)((function(){if("pending"!==c){Xe.forEach((function(e){return r.current.getLayer(e)?r.current.setLayoutProperty(e,"visibility",m[e]?"visible":"none"):console.warn("Layer '".concat(e,"' is not set on map"))}));var e=m.energy.flatMap((function(e){return Pe[e].map((function(e){return["==",["get","energie_utilisee"],e]}))}));r.current.setFilter("energy",["any"].concat((0,i.Z)(e)));var o=m.gasUsage.map((function(e){return["==",["get","code_grand_secteur"],e]}));r.current.setFilter("gasUsage",m.gasUsageGroup&&["any"].concat((0,i.Z)(o)))}}),[m,c]),(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(xe,{}),(0,k.jsxs)("div",{className:"map-wrap",children:[(0,k.jsx)(je,{className:"search-result-box",right:!0,top:!0,children:(0,k.jsx)(ke,{children:y.length>0&&y.map((function(e,r){return(0,k.jsx)(O,{result:e,onClick:C,onClickClose:P},"".concat(e.address,"-").concat(r))})).reverse()})}),(0,k.jsx)(je,{right:!0,bottom:!0,children:(0,k.jsx)(re,{data:Be,onToogleFeature:L,onToogleInGroup:function(e,r){switch(e){case"energy":Z(r);break;case"gasUsage":N(r);break;case"gasUsageGroup":D()}},layerDisplay:m,hasResults:y.length>0})}),(0,k.jsx)(je,{right:!0,top:!0,children:(0,k.jsx)(ce,{onAddressSelect:z})}),(0,k.jsx)("div",{ref:e,className:"map"})]})]})}var Ve=o(404),Ke=o(9008),Qe=o.n(Ke),$e=g.ZP.div.withConfig({displayName:"carte__MapWrapper",componentId:"sc-s81e68-0"})(["height:calc(100vh - ",");@media (min-width:992px){height:calc(100vh - ",");}"],p.EV,p.YG);var er=function(){return(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(Qe(),{children:(0,k.jsx)("title",{children:"Carte des r\xe9seaux : France Chaleur Urbaine"})}),(0,k.jsx)(Ve.ZP,{currentMenu:"/carte",fullscreen:!0,children:(0,k.jsx)($e,{children:(0,k.jsx)(He,{})})})]})}},3074:function(e,r,o){(window.__NEXT_P=window.__NEXT_P||[]).push(["/carte",function(){return o(6793)}])},5616:function(){}},function(e){e.O(0,[644,562,741,270,636,774,888,179],(function(){return r=3074,e(e.s=r);var r}));var r=e.O();_N_E=r}]);