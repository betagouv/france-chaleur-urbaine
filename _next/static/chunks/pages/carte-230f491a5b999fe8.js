(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[150],{2432:function(e,n,o){"use strict";o.r(n),o.d(n,{default:function(){return Ln}});var t,r,i=o(9499),a=o(7812),l=o(4730),s=o(6835),c=o(4041),d=o(103),u=o(1307),p=o.n(u),g=(o(2792),o(4613)),f=o.n(g),m=(o(6644),o(1163)),b=o(7294),h=o(856),y=o(2125),x="#18753c",v="#b8fec9",w="#ce0500",j="#ffe9e9",C="#000",k="#ccc",_=y.ZP.div.withConfig({displayName:"CardDetailsstyle__MapCard",componentId:"sc-m08mvi-0"})(["width:100%;display:block;position:relative;margin-bottom:8px;background-color:white;border:2px solid var(--bf500);border:1px solid rgb(0 0 0 / 20%);border-radius:0.3em;overflow:hidden;box-shadow:1px 0 4px 1px rgb(0 0 0 / 20%);> header{padding:8px 24px 8px 8px;cursor:",";font-weight:bold;}.closeButton{position:absolute;top:2px;right:2px;display:flex;justify-content:center;align-items:center;background-color:#ffffff;box-shadow:0 1px 2px 1px #33333333;width:1.25rem;height:1.25rem;border-radius:50%;::before,::after{content:'';position:absolute;width:2px;height:80%;background-color:#333;}::before{content:'';transform:rotate(-45deg);}::after{content:'';transform:rotate(45deg);}}&.eligible{border:2px solid ",";> header{background-color:",";color:",";}}&.ineligible{border:2px solid ",";> header{background-color:",";color:",";}}&.energyCard{border:2px solid ",";> header{background-color:",";color:",";}}&.gasUsageCard{border:2px solid ",";> header{background-color:",";color:",";}}&.legendCard{border:2px solid #4550e5;> header{background-color:#4550e5;color:#ffffff;}}section{padding:0.5em;overflow:auto;scrollbar-gutter:stable both-edges;max-height:calc(100vh - "," - 180px);transition:max-height 0.75s ease,padding 0.5s ease 0.25s;}&.close{section{max-height:0;padding:0 0.5em;}}"],(function(e){return e.isClickable?"pointer":"default"}),v,v,x,j,j,w,j,j,w,k,k,C,h.YG),z=y.ZP.div.withConfig({displayName:"CardDetailsstyle__EligibilityResult",componentId:"sc-m08mvi-1"})(["background-color:#eeeeee;padding:0.5em;margin-bottom:0.5em;border-left:2px solid;",""],(function(e){var n=e.isEligible;return(0,y.iv)(["border-color:","",";"],n?x:w,"a6")})),O=(y.ZP.div.withConfig({displayName:"CardDetailsstyle__EnergyResult",componentId:"sc-m08mvi-2"})(["padding:0.5em;margin-bottom:0.5em;border-left:2px solid;border-color:#c72e6e;"]),y.ZP.div.withConfig({displayName:"CardDetailsstyle__GasUsageResult",componentId:"sc-m08mvi-3"})(["padding:0.5em;margin-bottom:0.5em;border-left:2px solid;border-color:#136ce0;"]),o(5893)),P=function(e){var n,o,t,r=e.result,i=e.onClick,a=e.onClickClose,l=((null===(n=r.addressDetails)||void 0===n||null===(o=n.networkDetails)||void 0===o?void 0:o.network)||{}).distance,s=((null===(t=r.addressDetails)||void 0===t?void 0:t.networkDetails)||{}).isEligible;return(0,O.jsxs)(_,{isEligible:s,typeCard:"search",className:s?"eligible":"ineligible",isClickable:!0,children:[(0,O.jsx)("header",{onClick:function(e){var n="function"===typeof i&&i(r)||void 0;return e.stopPropagation(),n},children:r.address}),a&&(0,O.jsx)("button",{className:"closeButton",onClick:function(){a&&a(r)}}),(0,O.jsxs)("section",{children:[(0,O.jsx)(z,{isEligible:s,children:s?"Bonne nouvelle ! Un r\xe9seau de chaleur passe \xe0 proximit\xe9 de cette adresse.":"Cette adresse n'est pour le moment pas raccordable \xe0 un r\xe9seau de chaleur."}),(0,O.jsx)("div",{children:!isNaN(parseFloat(l))&&"Distance au r\xe9seau ".concat(l<1?"< 1m":l>=1e3?": ".concat(l/1e3,"km"):": ".concat(l,"m"))})]})]})};!function(e){e.Fuel="fuelOil",e.Gas="gas",e.Wood="wood",e.Electric="electric",e.Unknown="unknow"}(t||(t={})),function(e){e.Fioul="fioul",e.FioulDomestique="fioul_domestique",e.Gaz="gaz",e.GazNaturel="gaz_naturel",e.GazCollectif="gaz_collectif",e.GazPropaneButane="gaz_propane_butane",e.Charbon="charbon",e.BoisDeChauffage="bois_de_chauffage",e.Electricite="electricite",e.EnergieAutre="energie_autre",e.SansObjet="sans objet",e.Default="default"}(r||(r={}));var Z,L={a:{color:"#329A33"},b:{color:"#34CC33"},c:{color:"#34CC33"},d:{color:"#FFFF00"},e:{color:"#FFCC01"},f:{color:"#FF9A32"},g:{color:"#FF0000"},unknow:{color:"#999999"}},D=.65,N={color:"#FFFFFF",size:4},I={color:"#FF7576",size:2},E="B\xe2timents chauff\xe9s au fioul collectif",S="B\xe2timents chauff\xe9s au gaz collectif",F={fuelOil:{color:"#F07300"},gas:{color:"#B414FF"},wood:{color:"#955e15"},electric:{color:"#4cd362"},unknow:{color:"#818181"}},G={T:"Tertiaire",R:"Logements (tous types)",I:"Industrie",unknow:"Inconnu"},U={T:{color:"#0032E5"},R:{color:"#00B8F0"},I:{color:"#00efaf"},unknow:{color:"#818181"}},B={color:"#6DD627"},M={color:"#f0bb00",opacity:.46},T=[48.85294,2.34987];!function(e){e.outline="outline",e.demands="demands",e.zoneDP="zoneDP",e.buildings="buildings"}(Z||(Z={}));var A,W=Object.values(Z),R={outline:!0,zoneDP:!1,demands:!0,gasUsageGroup:!0,buildings:!1,gasUsage:["R","T","I"],energy:["fuelOil","gas"]},q=[{id:"heat-network",entries:[{id:"outline",label:"R\xe9seaux de chaleur",className:"legend-heat-network"}],type:"list"},{id:"zoneDP",entries:[{id:"zoneDP",label:"Zones de d\xe9veloppement prioritaires",info:"Dans cette zone, le raccordement des nouvelles constructions ou des b\xe2timents renouvelant leur installation de chauffage au dessus d'une puissance de 30 kW est obligatoire",className:"legend-zoneDP"}],type:"list"},"contributeButton","separator",{id:"demands",entries:[{id:"demands",label:"Demandes de raccordement sur France Chaleur Urbaine",className:"legend-demands"}],type:"list"},"separator",{id:"gasUsageGroup",entries:[{id:"gasUsageGroup",label:"Consommations globales de gaz",bgColor:"red"}],type:"group"},{id:"gasUsage",entries:R.gasUsage.map((function(e){return{id:e,label:G[e]||G.unknow,bgColor:U[e].color,className:"legend-energy"}})),subLegend:"GasUsage",type:"group",subGroup:!0,linkto:["gasUsageGroup"]},{id:"energy",entries:[{id:"gas",label:S,bgColor:F.gas.color}],subLegend:"EnergyGas",type:"group"},"separator",{id:"energy",entries:[{id:"fuelOil",label:E,bgColor:F.fuelOil.color}],subLegend:"EnergyFuel",type:"group"},"separator",{id:"buildings",entries:[{id:"buildings",label:"Autres donn\xe9es sur les b\xe2timents",subLegendTxt:"Cliquer sur le b\xe2timent souhait\xe9 pour obtenir plus d\u2019informations"}],type:"list"},"separator","sources"],X={minZoomData:12.75,minZoom:4,maxZoom:22,defaultZoom:12,lng:T[1],lat:T[0],defaultLayerDisplay:R,legendData:q};function Y(e,n){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),o.push.apply(o,t)}return o}function J(e){for(var n=1;n<arguments.length;n++){var o=null!=arguments[n]?arguments[n]:{};n%2?Y(Object(o),!0).forEach((function(n){(0,i.Z)(e,n,o[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):Y(Object(o)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(o,n))}))}return e}var V=X.minZoomData,H=X.maxZoom,K=10100,Q=(0,y.vJ)([".map-wrap{position:relative;display:flex;width:100%;height:100%;}.map{position:absolute;left:",";width:",";height:100%;}.maplibregl-control-container,.mapboxgl-control-container{> [class*=mapboxgl-]{z-index:",";}}.maplibregl-marker,.mapboxgl-marker{z-index:",";}.popover-map-search-form{z-index:"," !important;}.popup-map-layer{z-index:10101;font-size:14px;&.maplibregl-popup-anchor-left  .maplibregl-popup-tip{border-right-color:#4550e5;}&.maplibregl-popup-anchor-right  .maplibregl-popup-tip{border-left-color:#4550e5;}&.maplibregl-popup-anchor-top  .maplibregl-popup-tip{border-bottom-color:#4550e5;}&.maplibregl-popup-anchor-bottom  .maplibregl-popup-tip{border-top-color:#4550e5;}.maplibregl-popup-content{border:2px solid #4550e5;border-radius:0.3em;overflow:hidden;header{padding:8px;margin:-15px -10px 10px;background-color:#4550e5;h6{color:#fff;font-size:15px;font-weight:bold;margin:0;}}.maplibregl-popup-close-button{font-size:1.5em;line-height:0;font-weight:bold;color:#fff;display:flex;align-items:center;justify-content:center;width:1.25em;height:1.25em;padding:0 0 2px;margin:3px;border-radius:1em;transition-property:color,background-color;transition-duration:0.25s;transition-timing-function:ease;&:hover{color:#4550e5;background-color:#fff;}}}}"],(function(e){return e.legendCollapsed?"0px":"333px"}),(function(e){return e.legendCollapsed?"100%":"calc(100% - 333px)"}),1e4,1e4,10101),$=y.ZP.div.withConfig({displayName:"Mapstyle__MapControlWrapper",componentId:"sc-v57w17-0"})(["position:absolute;z-index:",";width:1000px;padding:1rem;bottom:0;left:",";"],K,(function(e){return e.legendCollapsed?"calc(50% - 500px)":"calc((50% + 166px) - 500px)"})),ee=y.ZP.div.withConfig({displayName:"Mapstyle__Legend",componentId:"sc-v57w17-1"})(["z-index:",";overflow:scroll;"," width:333px;padding:16px;background:#ffffff;border:1px solid #dddddd;box-shadow:0px 16px 16px -16px rgba(0,0,0,0.32),0px 8px 16px rgba(0,0,0,0.1);"],K,(function(e){return e.legendCollapsed&&(0,y.iv)(["display:none;"])})),ne=y.ZP.div.withConfig({displayName:"Mapstyle__LegendSeparator",componentId:"sc-v57w17-2"})(["width:100%;border:1px solid #e1e1e1;margin:16px 0;"]),oe=y.ZP.button.withConfig({displayName:"Mapstyle__CollapseLegend",componentId:"sc-v57w17-3"})(["position:absolute;padding:0 0 0 9px;z-index:",";left:",";top:50%;border-radius:10px;background-color:white;height:42px;width:22px;"],K,(function(e){return e.legendCollapsed?"-11px":"322px"})),te={type:"line",layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":B.color,"line-width":3,"line-opacity":["interpolate",["linear"],["zoom"],11,.75,15,1]}},re="nb_logements",ie=(A={},(0,i.Z)(A,r.Fioul,t.Fuel),(0,i.Z)(A,r.FioulDomestique,t.Fuel),(0,i.Z)(A,r.Gaz,t.Gas),(0,i.Z)(A,r.GazNaturel,t.Gas),(0,i.Z)(A,r.GazCollectif,t.Gas),(0,i.Z)(A,r.GazPropaneButane,t.Gas),(0,i.Z)(A,r.Charbon,t.Wood),(0,i.Z)(A,r.BoisDeChauffage,t.Wood),(0,i.Z)(A,r.Electricite,t.Electric),(0,i.Z)(A,r.EnergieAutre,t.Unknown),(0,i.Z)(A,r.SansObjet,t.Unknown),(0,i.Z)(A,r.Default,t.Unknown),A),ae=Object.entries(ie).reduce((function(e,n){var o=(0,s.Z)(n,2),t=o[0],r=o[1];return J(J({},e),{},(0,i.Z)({},r,[].concat((0,a.Z)(e[r]||[]),[t])))}),{}),le=[].concat((0,a.Z)(Object.entries(F).flatMap((function(e){var n=(0,s.Z)(e,2),o=n[0],t=n[1];return[ae[o],t.color]}))),[F.unknow.color]),se={type:"symbol",layout:{"icon-image":"energy-picto","symbol-sort-key":["-",["coalesce",["get",re],0]],"icon-size":["interpolate",["linear"],["zoom"],V+.1,["case",["<",["get",re],100],.25,["<",["get",re],1e3],.6,1],H,["case",["<",["get",re],100],.5,["<",["get",re],1e3],1.2,2]]},paint:{"icon-color":["match",["get","energie_utilisee"]].concat((0,a.Z)(le)),"icon-opacity":["interpolate",["linear"],["zoom"],V+.2,0,V+.5+1,.65]}},ce="conso_nb",de=[].concat((0,a.Z)(Object.entries(U).flatMap((function(e){var n=(0,s.Z)(e,2);return[n[0],n[1].color]}))),[U.unknow.color]),ue={type:"circle",layout:{"circle-sort-key":["-",["coalesce",["get",ce],0]]},paint:{"circle-color":["match",["get","code_grand"]].concat((0,a.Z)(de)),"circle-radius":["interpolate",["linear"],["zoom"],V+.1,["case",["<",["get",ce],100],4,["<",["get",ce],1e3],8,14],H,["case",["<",["get",ce],100],8,["<",["get",ce],1e3],16,28]],"circle-opacity":["interpolate",["linear"],["zoom"],V+.2,0,V+.2+1,.35],"circle-stroke-opacity":0}},pe={type:"circle",paint:{"circle-color":N.color,"circle-stroke-color":I.color,"circle-radius":N.size,"circle-stroke-width":I.size}},ge={type:"fill",paint:{"fill-color":M.color,"fill-opacity":M.opacity}},fe=[].concat((0,a.Z)(Object.entries(L).flatMap((function(e){var n=(0,s.Z)(e,2);return[n[0],n[1].color]}))),[L.unknow.color]),me={type:"fill",paint:{"fill-color":["match",["downcase",["get","dpe_energie"]]].concat((0,a.Z)(fe)),"fill-outline-color":"#555555","fill-opacity":["interpolate",["linear"],["zoom"],V+.2,0,V+.2+1,D]}},be=(y.ZP.div.withConfig({displayName:"Mapstyle__Buttons",componentId:"sc-v57w17-4"})(["display:flex;justify-content:space-evenly;"]),y.ZP.div.withConfig({displayName:"LegendEntrystyled__LabelLegendInputLabelWrapper",componentId:"sc-l6tz2c-0"})(["margin-left:4px;"])),he=y.ZP.div.withConfig({displayName:"LegendEntrystyled__LabelLegendInputLabel",componentId:"sc-l6tz2c-1"})(["display:flex;"]),ye=y.ZP.div.withConfig({displayName:"LegendEntrystyled__LabelLegendDescription",componentId:"sc-l6tz2c-2"})(["margin-left:8px;font-size:13px;line-height:1.5;"]),xe=y.ZP.div.withConfig({displayName:"LegendEntrystyled__LabelLegendWrapper",componentId:"sc-l6tz2c-3"})(["font-size:0.95em;display:flex;align-items:baseline;label{display:flex;flex-direction:row;align-items:baseline;}"]),ve=y.ZP.div.withConfig({displayName:"LegendEntrystyled__LabelLegend",componentId:"sc-l6tz2c-4"})(["display:flex;"]),we=y.ZP.div.withConfig({displayName:"LegendEntrystyled__LabelLegendMarker",componentId:"sc-l6tz2c-5"})(["width:32px;height:1rem;display:inline-flex;vertical-align:text-bottom;justify-content:center;align-items:center;margin:4px;position:relative;::before{content:'';display:block;height:1rem;}",""],(function(e){var n=e.bgColor;return n&&(0,y.iv)(["::before{background-color:",";}"],n)})),je=y.ZP.div.withConfig({displayName:"LegendEntrystyled__LabelLegendHead",componentId:"sc-l6tz2c-6"})(["font-size:14px;font-weight:600;line-height:18px;",""],(function(e){return"group"===e.type&&(0,y.iv)(["line-height:1.45;"])}));var Ce=function(e){var n=e.id,o=e.bgColor,t=e.className,r=e.type,i=e.label,a=e.info,l=e.subLegendTxt,s=e.checked,d=e.readOnly,u=e.onChange;return(0,O.jsxs)(xe,{children:[(0,O.jsx)("input",{type:"checkbox",checked:s,onChange:function(){!d&&u(n)}}),(0,O.jsxs)(be,{children:[(0,O.jsxs)(he,{children:[t&&(0,O.jsx)(we,{className:"legend-marker ".concat(t,"-marker"),bgColor:o&&"".concat(o)}),(0,O.jsxs)(ve,{children:[(0,O.jsx)(je,{type:r,children:i}),a&&(0,O.jsx)(c.Icon,{size:"lg",name:"ri-information-fill",title:a})]})]}),l&&(0,O.jsx)(ye,{children:l})]})]})},ke=y.ZP.div.withConfig({displayName:"ScaleLegendstyle__ScaleLegendWrapper",componentId:"sc-1i5z491-0"})(["margin-left:1.5rem;margin-bottom:4px;"]),_e=y.ZP.div.withConfig({displayName:"ScaleLegendstyle__ScaleLegendHeader",componentId:"sc-1i5z491-1"})(["font-size:0.8em;margin-bottom:0.2em;"]),ze=y.ZP.label.withConfig({displayName:"ScaleLegendstyle__ScaleLegendLabel",componentId:"sc-1i5z491-2"})(["display:inline-block;margin-bottom:0.2em;"]),Oe=y.ZP.input.withConfig({displayName:"ScaleLegendstyle__Input",componentId:"sc-1i5z491-3"})([""]),Pe=y.ZP.div.withConfig({displayName:"ScaleLegendstyle__ScaleLegendBody",componentId:"sc-1i5z491-4"})(["display:flex;justify-content:space-between;",""],(function(e){return e.checkbox&&(0,y.iv)(["padding:0 0.3em;"])})),Ze=y.ZP.div.withConfig({displayName:"ScaleLegendstyle__ScaleLegendLabelWrapper",componentId:"sc-1i5z491-5"})(["font-size:0.75em;white-space:nowrap;display:inline;position:relative;padding-right:0.5em;&:not(:last-child){margin-right:0.5em;}"]),Le=y.ZP.span.withConfig({displayName:"ScaleLegendstyle__ScaleLabelLegend",componentId:"sc-1i5z491-6"})(["width:",";height:1em;display:inline-flex;vertical-align:middle;justify-content:center;align-items:center;margin-right:0.2em;::before{content:'';display:block;position:relative;width:",";height:",";background-color:",";","}"],(function(e){var n=e.size;return"".concat(n,"rem")}),(function(e){var n=e.size;return"".concat(n,"em")}),(function(e){var n=e.size;return"".concat(n,"em")}),(function(e){return e.bgColor||"grey"}),(function(e){return e.circle&&(0,y.iv)(["border-radius:50%;"])})),De=function(e){var n=e.label,o=e.checkbox,t=e.checked,r=e.framed,i=e.onChange,a=e.color,l=e.scaleLabels,s=e.circle;return(0,O.jsxs)(ke,{framed:r,children:[o?(0,O.jsxs)(ze,{children:[(0,O.jsx)(Oe,{type:"checkbox",checked:t,onChange:i}),n]}):(0,O.jsx)(_e,{children:n}),(0,O.jsx)(Pe,{checkbox:o,children:l.map((function(e){var n=e.bgColor,o=e.label,t=e.size;return(0,O.jsxs)(Ze,{children:[(0,O.jsx)(Le,{bgColor:n||a,size:t,circle:s}),o]},o)}))})]})},Ne={Energy:function(){return(0,O.jsx)(De,{label:"Nombre de lots d'habitation",color:F.gas.color,scaleLabels:[{label:"<\xa0100",size:.5},{label:"100\xa0\xe0\xa01000",size:1},{label:">\xa01000",size:2}]})},EnergyGas:function(){return(0,O.jsx)(De,{label:"Nombre de lots d'habitation",color:"".concat(F.gas.color,"88"),scaleLabels:[{label:"<\xa0100",size:.8},{label:"100\xa0\xe0\xa01000",size:1.3},{label:">\xa01000",size:2}]})},EnergyFuel:function(){return(0,O.jsx)(De,{label:"Nombre de lots d'habitation",color:"".concat(F.fuelOil.color,"88"),scaleLabels:[{label:"<\xa0100",size:.8},{label:"100\xa0\xe0\xa01000",size:1.3},{label:">\xa01000",size:2}]})},GasUsage:function(){return(0,O.jsx)(De,{circle:!0,label:"Niveau de consommation de gaz (MWh)",color:"#D9D9D9",scaleLabels:[{label:"<\xa0100",size:.8},{label:"100\xa0\xe0\xa01000",size:1.3},{label:">\xa01000",size:2}]})}},Ie=(0,y.vJ)([".legend-label-description{font-size:15px;font-size:0.95em;em{display:block;line-height:1.2;font-size:11px;font-size:0.7em;color:#8D93A1}}"]),Ee=y.ZP.div.withConfig({displayName:"LegendGroupLabelstyled__GroupeLabelWrapper",componentId:"sc-1uvbh00-0"})(["padding-bottom:0.15em;transition:opacity 0.25s ease-in-out;"," &:last-child{padding-bottom:0;}header{font-weight:bold;margin-bottom:0.2em;font-size:1.15em;}.groupe-label-body{display:flex;flex-wrap:wrap;gap:8px;padding:0 0 0.4rem 0;&.subGroup{margin-left:1.5em;}.label-item{flex:1;min-width:30%;max-width:100%;display:flex;text-align:left;justify-content:flex-start;label{display:inline;white-space:nowrap;&::before{width:0.7em;}}}}"],(function(e){return e.disable&&(0,y.iv)(["opacity:0.3;"])}));function Se(e,n){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),o.push.apply(o,t)}return o}var Fe=function(e){var n,o=e.id,t=e.subLegend,r=e.entries,a=e.subGroup,l=e.layerDisplay,s=e.linkto,c=e.onChangeEntry,d=(0,b.useMemo)((function(){return null===s||void 0===s?void 0:s.map((function(e){return null===l||void 0===l?void 0:l[e]})).some((function(e){return!1===e}))}),[l,s]);return(0,O.jsxs)(O.Fragment,{children:[(0,O.jsx)(Ie,{}),(0,O.jsxs)(Ee,{disable:d,children:[(0,O.jsx)("div",{className:"groupe-label-body ".concat(a?"subGroup":""),children:r.map((function(e){var n;return(0,O.jsx)(Ce,function(e){for(var n=1;n<arguments.length;n++){var o=null!=arguments[n]?arguments[n]:{};n%2?Se(Object(o),!0).forEach((function(n){(0,i.Z)(e,n,o[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):Se(Object(o)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(o,n))}))}return e}({checked:(null===l||void 0===l?void 0:l[o])instanceof Array?null===l||void 0===l||null===(n=l[o])||void 0===n?void 0:n.includes(e.id):null===l||void 0===l?void 0:l[o],type:a?"subGroup":"group",onChange:function(){return c(o,null===e||void 0===e?void 0:e.id)},readOnly:d},e),e.id)}))}),t&&(null===Ne||void 0===Ne||null===(n=Ne[t])||void 0===n?void 0:n.call(Ne))]})]})},Ge=((0,y.vJ)([".leaflet-container .leaflet-control-attribution{margin:0.5em 0;padding:0 0.5em;background:rgba(255,255,255,0.85);font-weight:bold;padding-left:3rem;position:relative;}.leaflet-control-attribution{position:relative;border-radius:1em 0 0 1em;overflow:hidden;cursor:default;transform:translateX(calc(100% - 3em));transition:transform 0.4s ease;&::before{content:'\xa9';position:absolute;left:0;height:100%;display:inline-flex;align-items:center;justify-content:center;width:3rem;padding-left:1.25em;padding-right:0.5em;margin-right:0.5em;margin-left:-0.5em;border-right:1px solid #fff;background-color:#4550e5;color:#fff;font-weight:bold;cursor:pointer;}&::after{content:'';position:absolute;left:0;top:50%;width:0em;height:0em;border:0 none transparent;border-left:0.5em solid transparent;border-right:0.5em solid transparent;border-bottom:0.5em solid #fff;transform:translateY(calc(-50% - .05em)) rotate(-90deg) translateY(.45em);transition:transform 0.5s ease;}&:hover{transform:translateX(0);&::after{transform:translateY(calc(-50% - .05em)) rotate(90deg) translateY(-.45em);}}a[target]{color:#4550e5;&::after{content:'';}}}.my-div-icon{position:relative;i{position:relative;display:block;transform-origin:bottom;::before{content:\"\";display:block;position:absolute;bottom:0;left:0;width:2.5rem;height:2.5rem;background-color:#4550e5;border:2px solid white;border-radius:50% 45% 75% 0% / 75% 45% 50% 0%;transform-origin:bottom left;transform:translateX(6px) translateY(-3px) rotate(-45deg);box-shadow:-3px 3px 4px 3px rgb(0 0 0 / 35%)}::after{content:\"\";display:block;position:absolute;top:0;left:0;width:1.3rem;height:1.3rem;border:5px double white;border-radius:50%;transform:translateX(6px) translateY(-3px) translateX(-.65rem) translateY(-.65rem) translateY(-1.8rem);}}}.pan-map-aside{width:100%;}"]),(0,y.vJ)(["hr{border:1px solid #4550e5;border-width:0 0 1px;margin:.75em 1.25em;height:0;}.legend-heat-network-marker{top:-2px;:before{margin:0 4px;width:24px;height:0;border:3px solid ",";border-radius:3px;margin-bottom:calc(0.25em - 1.5px)}}.legend-zoneDP-marker{:before{margin:0 4px;width:32px;background-color:",";opacity:",";margin-bottom:calc(0.25em - 1.5px)}}.legend-demands-marker{:before{width:14px;height:14px;border-radius:50%;background-color:",";border:2px solid ",";}}.legend-energy-marker{width:.6rem;::before{width:0.5rem;height:0.5rem;border-radius:50%;margin-bottom:calc(0.25em - 1.5px);}}"],B.color,M.color,M.opacity,N.color,I.color)),Ue=y.ZP.div.withConfig({displayName:"MapLegendstyle__LegendButton",componentId:"sc-wyifbx-0"})(["display:flex;justify-content:center;margin-top:8px;"]),Be=y.ZP.div.withConfig({displayName:"MapLegendstyle__Sources",componentId:"sc-wyifbx-1"})(["color:#8d93a1;font-size:10px;position:relative;a{position:absolute;top:-16px;}"]);function Me(e,n){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),o.push.apply(o,t)}return o}var Te,Ae=function(e){var n=e.data,o=e.layerDisplay,t=e.onToogleFeature,r=e.onToogleInGroup,a=(0,m.useRouter)();return(0,O.jsxs)(O.Fragment,{children:[(0,O.jsx)(Ge,{}),n.map((function(e,n){if("separator"===e)return(0,O.jsx)(ne,{},"separator-".concat(n));if("contributeButton"===e)return(0,O.jsx)(Ue,{children:(0,O.jsx)(c.Button,{icon:"ri-upload-2-line",onClick:function(){return a.push("/contribution")},size:"sm",children:"Contribuer"})},"contribute-button");if("sources"===e)return(0,O.jsx)(Be,{children:(0,O.jsx)(c.Link,{href:"/carto_sources.pdf",target:"_blank",children:"Sources"},"sources")});if("object"===typeof e){var l=e.id,s=e.subGroup,d=e.entries,u=e.subLegend,p=e.linkto,g=e.type,f=void 0===g?"list":g;if("group"===f)return(0,O.jsx)(Fe,{layerDisplay:o,id:l,subLegend:u,subGroup:s,entries:d,linkto:p,onChangeEntry:r},"group-".concat(l,"-").concat(u));if("list"===f)return d.map((function(e){return(0,O.jsx)(Ce,function(e){for(var n=1;n<arguments.length;n++){var o=null!=arguments[n]?arguments[n]:{};n%2?Me(Object(o),!0).forEach((function(n){(0,i.Z)(e,n,o[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):Me(Object(o)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(o,n))}))}return e}({checked:!!o[e.id],onChange:t},e),e.id)}))}return null}))]})},We=o(29),Re=o(7794),qe=o.n(Re),Xe=o(948),Ye=o(3598),Je=(0,y.vJ)([".map-search-form{width:100%;margin-bottom:0 !important;}.popover-map-search-form{z-index:1000;}"]),Ve=function(e){var n=e.onAddressSelect,o=(0,Ye.Su)().heatNetworkService,t=function(){var e=(0,We.Z)(qe().mark((function e(t,r){var i,a,l,c,d,u;return qe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=(0,s.Z)(r,2),a=i[0],l=i[1],c={lat:l,lon:a},e.next=4,o.findByCoords(c);case 4:d=e.sent,u={networkDetails:d},n&&n(t,[l,a],u);case 7:case"end":return e.stop()}}),e)})));return function(n,o){return e.apply(this,arguments)}}();return(0,O.jsxs)(O.Fragment,{children:[(0,O.jsx)(Je,{}),(0,O.jsx)(Xe.Z,{placeholder:"Rechercher une adresse",onAddressSelected:t,className:"map-search-form",popoverClassName:"popover-map-search-form"})]})};!function(e){e.CSV="csv",e.XLSX="xlsx"}(Te||(Te={}));var He=y.ZP.div.withConfig({displayName:"ZoneInfostyle__ZoneInfoWrapper",componentId:"sc-e55lau-0"})(["display:flex;flex:1;gap:4px;"]),Ke=y.ZP.div.withConfig({displayName:"ZoneInfostyle__IconWrapper",componentId:"sc-e55lau-1"})(["display:inline;position:relative;",""],(function(e){return e.withBackground&&(0,y.iv)(["background-color:#f4f7fe;border-radius:50%;padding:1px 8px 0 8px;max-height:25px;max-width:25px;img{position:relative;top:2px;}"])})),Qe=y.ZP.div.withConfig({displayName:"ZoneInfostyle__Info",componentId:"sc-e55lau-2"})(["display:flex;flex-direction:column;",""],(function(e){return!e.alignTop&&(0,y.iv)(["justify-content:space-between;"])})),$e=y.ZP.div.withConfig({displayName:"ZoneInfostyle__Title",componentId:"sc-e55lau-3"})(["font-weight:600;font-size:14px;margin-bottom:8px;"]),en=y.ZP.span.withConfig({displayName:"ZoneInfostyle__Label",componentId:"sc-e55lau-4"})(["font-weight:500;font-size:12px;color:#a3aed0;margin-left:4px;"]),nn=y.ZP.span.withConfig({displayName:"ZoneInfostyle__Value",componentId:"sc-e55lau-5"})(["font-weight:700;font-size:14px;",""],(function(e){return"blue"===e.color?(0,y.iv)(["color:#4550e5;"]):(0,y.iv)(["color:#56a131;"])})),on=function(e){var n=e.color,o=e.alignTop,t=e.withBackground,r=e.title,i=e.icon,a=e.values;return(0,O.jsxs)(He,{children:[i&&(0,O.jsx)(Ke,{withBackground:t,children:(0,O.jsx)("img",{src:"/icons/picto-".concat(i,".svg"),alt:""})}),(0,O.jsxs)(Qe,{alignTop:o,children:[(0,O.jsx)($e,{children:r}),(0,O.jsx)("div",{children:a.map((function(e){var o=e.value,t=e.label;return(0,O.jsxs)("div",{children:[(0,O.jsx)(nn,{color:n,children:o}),(0,O.jsx)(en,{children:t})]},t)}))})]})]})},tn=y.ZP.div.withConfig({displayName:"ZoneInfosstyle__Container",componentId:"sc-16smymp-0"})(["display:flex;align-items:center;flex-direction:column;gap:4px;",""],(function(e){return e.customCursor&&(0,y.iv)(["cursor:crosshair !important;"])})),rn=y.ZP.div.withConfig({displayName:"ZoneInfosstyle__ZoneInfosWrapper",componentId:"sc-16smymp-1"})(["position:relative;max-width:1000px;display:flex;gap:16px;background-color:white;padding:16px;border-radius:8px;box-shadow:0px 16px 16px -16px rgba(0,0,0,0.32),0px 8px 16px rgba(0,0,0,0.1);"]),an=(0,y.ZP)(c.Button).withConfig({displayName:"ZoneInfosstyle__ExportButton",componentId:"sc-16smymp-2"})(["position:absolute;right:16px;bottom:16px;"]),ln=function(e){var n=e.map,o=e.draw,t=(0,Ye.Su)().heatNetworkService,r=(0,b.useState)(!1),i=r[0],a=r[1],l=(0,b.useState)(!1),s=l[0],d=l[1],u=(0,b.useState)(),p=u[0],g=u[1],f=(0,b.useState)(),m=f[0],h=f[1];(0,b.useEffect)((function(){n&&o&&(n.on("draw.create",(function(){var e=o.getAll().features[0].geometry;g(e.coordinates[0])})),n.on("draw.update",(function(){var e=o.getAll().features[0].geometry;g(e.coordinates[0])})),n.on("draw.modechange",(function(e){"simple_select"===e.mode&&a(!1)})))}),[n,o]),(0,b.useEffect)((function(){h(void 0),p&&t.summary(p).then(h)}),[t,p]);var y=(0,b.useCallback)((0,We.Z)(qe().mark((function e(){return qe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!p){e.next=5;break}return d(!0),e.next=4,t.downloadSummary(p,Te.CSV);case 4:d(!1);case 5:case"end":return e.stop()}}),e)}))),[t,p]);return(0,O.jsxs)(tn,{customCursor:i,children:[(0,O.jsx)(c.Button,{icon:"ri-edit-2-line",size:"sm",secondary:!0,onClick:function(){g(void 0),a(!0),o.deleteAll(),o.changeMode("draw_polygon")},children:"D\xe9finir une zone"}),(0,O.jsx)(rn,{children:m?(0,O.jsxs)(O.Fragment,{children:[(0,O.jsx)(on,{color:"blue",title:"B\xe2timents \xe0 chauffage collectif fioul",icon:"fioul",withBackground:!0,values:[{label:"Total",value:m.energy.filter((function(e){return"fuelOil"===ie[e.energie_utilisee]})).length},{label:"Proche r\xe9seau (<50 m)",value:m.closeEnergy.filter((function(e){return"fuelOil"===ie[e.energie_utilisee]})).length}]}),(0,O.jsx)(on,{color:"blue",title:"B\xe2timents \xe0 chauffage collectif gaz",icon:"gaz",withBackground:!0,values:[{label:"Total",value:m.energy.filter((function(e){return"gas"===ie[e.energie_utilisee]})).length},{label:"Proche r\xe9seau (<50 m)",value:m.closeEnergy.filter((function(e){return"gas"===ie[e.energie_utilisee]})).length}]}),(0,O.jsx)(on,{color:"blue",title:"Consommations de gaz",values:[{label:"Total",value:"".concat((m.gas.reduce((function(e,n){return e+ +n.conso_nb}),0)/1e3).toFixed(2)," GWh")},{label:"Proche r\xe9seau (<50 m)",value:"".concat((m.closeGas.reduce((function(e,n){return e+ +n.conso_nb}),0)/1e3).toFixed(2)," GWh")}]}),(0,O.jsx)(on,{color:"green",alignTop:!0,title:"R\xe9seaux de chaleur",icon:"traces",values:[{label:"Km",value:(m.network.reduce((function(e,n){return e+n.length}),0)/1e3).toFixed(2)}]}),(0,O.jsx)(an,{size:"sm",icon:"ri-download-2-line",onClick:y,disabled:s,children:"Exporter"})]}):(0,O.jsx)("span",{children:p?"Calcul des statistiques en cours (peut \xeatre long si la zone d\xe9finie est trop grande)...":'Pour afficher et exporter des donn\xe9es sur les modes de chauffage, consommations de gaz et r\xe9seaux de chaleur, d\xe9finissez une zone en cliquant sur au moins trois points puis en appuyant sur "Entr\xe9e".'})})]})};function sn(e,n){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),o.push.apply(o,t)}return o}function cn(e){for(var n=1;n<arguments.length;n++){var o=null!=arguments[n]?arguments[n]:{};n%2?sn(Object(o),!0).forEach((function(n){(0,i.Z)(e,n,o[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):sn(Object(o)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(o,n))}))}return e}var dn=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=n.className,t=n.bodyFormater,r=(0,b.useRef)([]),i=(0,b.useRef)(new(f().Popup)({className:o})),l=(0,b.useState)([]),c=l[0],d=l[1],u=(0,b.useCallback)((function(e,n){var o,t=n.buildings,i=n.consommation,l=n.demands,c=n.energy,u=(0,s.Z)(e,2),p=u[0],g=u[1],f="".concat(p.toFixed(4),"--").concat(g.toFixed(4)),m=function(e){return e.id===f};r.current=[].concat((0,a.Z)(r.current.filter((o=m,function(){return!o.apply(void 0,arguments)}))),[cn(cn(cn(cn(cn({},r.current.find(m)||{}),{},{id:f,coordinates:e},t?{buildings:t}:{}),i?{consommation:i}:{}),l?{demands:l}:{}),c?{energy:c}:{})]),d(r.current)}),[]),p=(0,b.useCallback)((function(n){var o=n.coordinates,r=t?t(n):JSON.stringify(n);i.current.setLngLat(o).setHTML(r).addTo(e)}),[t,e]);return(0,b.useEffect)((function(){var e=c[c.length-1];e&&p(e)}),[c,p]),[i.current,c,u]},un=o(3454),pn=["marker"];function gn(e,n){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),o.push.apply(o,t)}return o}function fn(e){for(var n=1;n<arguments.length;n++){var o=null!=arguments[n]?arguments[n]:{};n%2?gn(Object(o),!0).forEach((function(n){(0,i.Z)(e,n,o[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):gn(Object(o)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(o,n))}))}return e}var mn=X.defaultZoom,bn=X.maxZoom,hn=X.minZoom,yn=X.minZoomData,xn=X.lng,vn=X.lat,wn=X.defaultLayerDisplay,jn=X.legendData,Cn=function(e){var n,o=e.buildings,t=e.consommation,r=e.demands,i=e.energy,a=o||{},l=a.nb_logements,s=a.annee_construction,c=a.type_usage,d=a.energie_utilisee,u=a.type_chauffage,p=a.addr_label,g=a.dpe_energie,f=a.dpe_ges,m=i||{},b=m.addr_label,h=m.nb_logements,y=m.annee_construction,x=m.energie_utilisee,v=t||{},w=v.adresse,j=v.code_grand,C=v.conso_nb,k=r||{},_=k.Adresse,z=k["Mode de chauffage"],O=p||w||b||_,P=l||h,Z=s||y,L=d||x,D=u||z;return"\n    ".concat(O?"\n          <header>\n            <h6>".concat(O,"</h6>\n          </header>"):"","\n    ","\n        <section>\n          ".concat(j?"<strong><u></u>".concat(function(e){switch(e){case"R":return"Logement residentiel";case"T":return"\xc9tablissement tertiaire";case"I":return"Industrie"}return""}(j),"</u></strong><br />"):i?"<strong><u>Copropri\xe9t\xe9</u></strong><br />":"","\n          ").concat(Z?"<strong>Ann\xe9e de construction&nbsp;:</strong> ".concat(Z,"<br />"):"","\n          ").concat(c?"<strong>usage&nbsp;:</strong> ".concat(c,"<br />"):"","\n          ").concat(P?"<strong>Nombre de logements&nbsp;:</strong> ".concat(P,"<br />"):"","\n          ").concat(L?"<strong>Chauffage actuel&nbsp;:</strong> ".concat((n=L,n&&n.replace(/_/g," ").toLowerCase()),"<br />"):"","\n          ").concat(C&&(!L||null!==ae&&void 0!==ae&&ae.gas.includes(L))?"<strong>Consommations de gaz&nbsp;:</strong> ".concat(C.toFixed(2),"&nbsp;MWh<br />"):"","\n          ").concat(D?"<strong>Mode de chauffage&nbsp;:</strong> ".concat(D||"inconnu","<br />"):"","\n          ").concat(g?"<strong>DPE consommations \xe9nerg\xe9tiques&nbsp;:</strong> ".concat(g||"inconnu","<br />"):"","\n          ").concat(f?"<strong>DPE \xe9missions de gaz \xe0 effet de serre&nbsp;:</strong> ".concat(f||"inconnu","<br />"):"","\n        </section>\n      "),"\n  ")},kn=function(e){return"".concat(e.join("--"))};function _n(){var e=(0,b.useRef)(null),n=(0,b.useRef)(null),o=(0,b.useRef)(null),t=(0,b.useState)(!1),r=t[0],u=t[1];(0,b.useEffect)((function(){n&&n.current&&n.current.resize()}),[n,r]);var g=(0,b.useState)("pending"),h=g[0],y=g[1],x=(0,b.useState)(wn),v=x[0],w=x[1],j=(0,d.V_)("mapSoughtAddress",[],{beforeStorage:function(e){return e.map((function(e){e.marker;return(0,l.Z)(e,pn)}))}}),C=(0,s.Z)(j,2),k=C[0],_=C[1],z=(0,m.useRouter)(),Z=dn(n.current,{bodyFormater:Cn,className:"popup-map-layer"}),L=(0,s.Z)(Z,3)[2],D=(0,b.useCallback)((function(e){var o=e.coordinates;n.current.flyTo({center:{lon:o[0],lat:o[1]},zoom:16})}),[]),N=(0,b.useCallback)((function(e,n,o){var t=[n[1],n[0]],r={date:Date.now()},i=kn(t);if(Array.isArray(k)){var l=k.find((function(e){return e.id===i}))||{id:i,coordinates:t,address:e,addressDetails:o,search:r};_([].concat((0,a.Z)(k.filter((function(e){var n=e.id;return"".concat(n)!==i}))),[l])),D({coordinates:t})}}),[D,_,k]),I=(0,b.useCallback)((function(e){var n;if(e.coordinates){var o=kn(e.coordinates),t=k.filter((function(e){var n=e.coordinates;return kn(n)!==o}));null===e||void 0===e||null===(n=e.marker)||void 0===n||n.remove(),_(t)}}),[_,k]),E=(0,b.useCallback)((function(e){var n;w(fn(fn({},v),{},(0,i.Z)({},e,null!==(n=!(null!==v&&void 0!==v&&v[e]))&&void 0!==n&&n)))}),[v]),S=(0,b.useCallback)((function(e){var n=new Set(v.energy);n.has(e)?n.delete(e):n.add(e),w(fn(fn({},v),{},{energy:Array.from(n)}))}),[v]),F=(0,b.useCallback)((function(e){var n=new Set(v.gasUsage);n.has(e)?n.delete(e):n.add(e),w(fn(fn({},v),{},{gasUsage:Array.from(n)}))}),[v]),G=(0,b.useCallback)((function(){w(fn(fn({},v),{},{gasUsageGroup:!v.gasUsageGroup}))}),[v]);(0,b.useEffect)((function(){"loaded"===h||n.current||(o.current=new(p())({displayControlsDefault:!1}),n.current=new(f().Map)({attributionControl:!1,container:e.current,style:"https://openmaptiles.geo.data.gouv.fr/styles/osm-bright/style.json",center:[xn,vn],zoom:mn,maxZoom:bn,minZoom:hn}),n.current.addControl(o.current),n.current.on("load",(function(){n.current.loadImage("./icons/rect.png",(function(e,o){var t;if(e)throw e;y("loaded"),n.current.addImage("energy-picto",o,{sdf:!0});var r=new(f().NavigationControl)({showCompass:!0,showZoom:!0,visualizePitch:!0});n.current.addControl(r,"top-left");var i=new(f().AttributionControl)({compact:!1});n.current.addControl(i,"bottom-right");var a=new(f().ScaleControl)({maxWidth:100,unit:"metric"});n.current.addControl(a,"bottom-left");var l=null!==(t=un.env.NEXT_PUBLIC_MAP_ORIGIN)&&void 0!==t?t:document.location.origin;n.current.addSource("heatNetwork",{type:"vector",tiles:["".concat(l,"/api/map/network/{z}/{x}/{y}")]}),n.current.addLayer(fn({id:"outline",source:"heatNetwork","source-layer":"outline"},te)),n.current.addSource("zoneDP",{type:"vector",tiles:["".concat(l,"/api/map/zoneDP/{z}/{x}/{y}")]}),n.current.addLayer(fn({id:"zoneDP",source:"zoneDP","source-layer":"zoneDP"},ge)),n.current.addSource("buildings",{type:"vector",tiles:["".concat(l,"/api/map/buildings/{z}/{x}/{y}")],maxzoom:bn,minzoom:yn}),n.current.addLayer(fn({id:"buildings",source:"buildings","source-layer":"buildings"},me)),n.current.on("click","buildings",(function(e){var n=e.features[0].properties,o=e.lngLat,t=o.lat,r=o.lng;L([r,t],{buildings:n})})),n.current.on("mouseenter","buildings",(function(){n.current.getCanvas().style.cursor="pointer"})),n.current.on("mouseleave","buildings",(function(){n.current.getCanvas().style.cursor=""})),n.current.addSource("gasUsage",{type:"vector",tiles:["".concat(l,"/api/map/gas/{z}/{x}/{y}")],maxzoom:bn,minzoom:yn}),n.current.addLayer(fn({id:"gasUsage",source:"gasUsage","source-layer":"gasUsage"},ue)),n.current.on("click","gasUsage",(function(e){var n=e.features[0].properties,o=e.features[0].geometry.coordinates.slice();L(o,{consommation:n})})),n.current.on("mouseenter","gasUsage",(function(){n.current.getCanvas().style.cursor="pointer"})),n.current.on("mouseleave","gasUsage",(function(){n.current.getCanvas().style.cursor=""})),n.current.addSource("energy",{type:"vector",tiles:["".concat(l,"/api/map/energy/{z}/{x}/{y}")],maxzoom:bn,minzoom:yn}),n.current.addLayer(fn({id:"energy",source:"energy","source-layer":"energy"},se)),n.current.on("click","energy",(function(e){var n=e.features[0].properties,o=e.features[0].geometry.coordinates.slice();L(o,{energy:n})})),n.current.on("mouseenter","energy",(function(){n.current.getCanvas().style.cursor="pointer"})),n.current.on("mouseleave","energy",(function(){n.current.getCanvas().style.cursor=""})),n.current.addSource("demands",{type:"vector",tiles:["".concat(l,"/api/map/demands/{z}/{x}/{y}")],maxzoom:bn,minzoom:yn}),n.current.addLayer(fn({id:"demands",source:"demands","source-layer":"demands"},pe)),n.current.on("click","demands",(function(e){var n=e.features[0].properties,o=e.features[0].geometry.coordinates.slice();L(o,{demands:n})})),n.current.on("mouseenter","demands",(function(){n.current.getCanvas().style.cursor="pointer"})),n.current.on("mouseleave","demands",(function(){n.current.getCanvas().style.cursor=""}))}))})))}));var U=(0,b.useState)({}),B=U[0],M=U[1];return(0,b.useEffect)((function(){var e=B.coord,o=z.query.coord;if(o&&o!==e){var t="string"===typeof o?o.split(",").map((function(e){return parseFloat(e)})).reverse():o;D({coordinates:t}),M(z.query),new(f().Marker)({color:"#ea7c3f"}).setLngLat(t).addTo(n.current)}}),[D,z.query,B]),(0,b.useEffect)((function(){var e=!1,o=k.map((function(o){if(o.marker)return o;var t=new(f().Marker)({color:"#4550e5"}).setLngLat(o.coordinates).addTo(n.current);return e=!0,fn({marker:t},o)}));e&&_(o)}),[_,k]),(0,b.useEffect)((function(){if("pending"!==h){W.forEach((function(e){return n.current.getLayer(e)?n.current.setLayoutProperty(e,"visibility",v[e]?"visible":"none"):console.warn("Layer '".concat(e,"' is not set on map"))}));var e=v.energy.flatMap((function(e){return ae[e].map((function(e){return["==",["get","energie_utilisee"],e]}))}));n.current.setFilter("energy",["any"].concat((0,a.Z)(e)));var o=v.gasUsage.map((function(e){return["==",["get","code_grand"],e]}));n.current.setFilter("gasUsage",v.gasUsageGroup&&["any"].concat((0,a.Z)(o)))}}),[v,h]),(0,O.jsxs)(O.Fragment,{children:[(0,O.jsx)(Q,{legendCollapsed:r}),(0,O.jsxs)("div",{className:"map-wrap",children:[(0,O.jsx)(oe,{legendCollapsed:r,onClick:function(){return u(!r)},children:(0,O.jsx)(c.Icon,{name:r?"ri-arrow-right-s-line":"ri-arrow-left-s-line"})}),(0,O.jsxs)(ee,{legendCollapsed:r,children:[(0,O.jsx)(Ve,{onAddressSelect:N}),(0,O.jsx)(ne,{}),k.length>0&&(0,O.jsxs)(O.Fragment,{children:[k.map((function(e,n){return(0,O.jsx)(P,{result:e,onClick:D,onClickClose:I},"".concat(e.address,"-").concat(n))})).reverse(),(0,O.jsx)(ne,{})]}),(0,O.jsx)(Ae,{data:jn,onToogleFeature:E,onToogleInGroup:function(e,n){switch(e){case"energy":S(n);break;case"gasUsage":F(n);break;case"gasUsageGroup":G()}},layerDisplay:v})]}),(0,O.jsx)($,{legendCollapsed:r,children:(0,O.jsx)(ln,{map:n.current,draw:o.current})}),(0,O.jsx)("div",{ref:e,className:"map"})]})]})}var zn=o(9576),On=o(9008),Pn=o.n(On),Zn=y.ZP.div.withConfig({displayName:"carte__MapWrapper",componentId:"sc-s81e68-0"})(["height:calc(100vh - ",");@media (min-width:992px){height:calc(100vh - ",");}"],h.EV,h.YG);var Ln=function(){return(0,O.jsxs)(O.Fragment,{children:[(0,O.jsx)(Pn(),{children:(0,O.jsx)("title",{children:"Carte des r\xe9seaux : France Chaleur Urbaine"})}),(0,O.jsx)(zn.ZP,{currentMenu:"/carte",fullscreen:!0,children:(0,O.jsx)(Zn,{children:(0,O.jsx)(_n,{})})})]})}},3074:function(e,n,o){(window.__NEXT_P=window.__NEXT_P||[]).push(["/carte",function(){return o(2432)}])}},function(e){e.O(0,[644,741,109,149,774,888,179],(function(){return n=3074,e(e.s=n);var n}));var n=e.O();_N_E=n}]);