import { useState } from 'react';

import { CampagneAfficheImage, FeatureLink, FullWidthImage } from '@/components/CollectivitesExploitantsPage.style';
import IframeIntegration from '@/components/GenericContent/IframeIntegration';
import { RoutedLink } from '@/components/MarkdownWrapper/MarkdownWrapper';
import { ArrowItem } from '@/components/MarkdownWrapper/MarkdownWrapper.style';
import NetworkSearchInput from '@/components/Network/NetworkSearchInput';
import Newsletter from '@/components/Newsletter/Newsletter';
import Partners from '@/components/Partners/Partners';
import { growths, issues } from '@/components/Ressources/config';
import Understanding from '@/components/Ressources/Understanding';
import SimplePage from '@/components/shared/page/SimplePage';
import { ResponsiveRow } from '@/components/ui/Box';
import Button from '@/components/ui/Button';
import Heading from '@/components/ui/Heading';
import Hero, { HeroContent, HeroSubtitle, HeroTitle } from '@/components/ui/Hero';
import Image from '@/components/ui/Image';
import Link from '@/components/ui/Link';
import Section, { SectionContent, SectionHeading, SectionSubtitle, SectionTitle, SectionTwoColumns } from '@/components/ui/Section';
import statistics from '@/data/statistics';

import type { NetworkSearchResult } from './api/networks/search';

const collectivitesCards = {
  etat: growths.etat,
  livraisons: issues.livraisons,
  role: issues.role,
};

function CollectivitesEtExploitantsPage() {
  const [networkSearchTerm, setNetworkSearchTerm] = useState('');
  const [selectedNetwork, setSelectedNetwork] = useState<NetworkSearchResult | null>(null);
  return (
    <SimplePage
      title="Collectivités, développez votre réseau de chaleur"
      description="Identifiez son potentiel de développement sur notre carte, découvrez nos outils et services pour faire connaître votre réseau, multipliez les raccordements."
    >
      <Hero image="/img/collectivite_header.webp" variant="light" imageType="inline">
        <HeroTitle>Valorisons les réseaux de chaleur, levier de la transition énergétique</HeroTitle>
        <HeroSubtitle>France Chaleur Urbaine, une plateforme collaborative pour accélérer les raccordements</HeroSubtitle>
        <HeroContent>
          <div className="flex gap-2 items-center justify-start">
            <Link variant="primary" href="#beneficier-du-service">
              Bénéficier du service
            </Link>
            <Link variant="secondary" href="/carte">
              Voir la cartographie
            </Link>
          </div>
        </HeroContent>
      </Hero>

      <Section>
        <SectionTitle>France Chaleur Urbaine c’est&nbsp;:</SectionTitle>
        <SectionContent>
          <ResponsiveRow>
            <div className="flex-1">
              <Heading size="h4" as="h3" color="blue-france">
                La cartographie interactive des réseaux de chaleur et de froid la plus complète à l’échelle nationale
              </Heading>
              <ArrowItem>
                <div className="text-lg text-grey!">
                  {statistics.networks} tracés en open data, représentant {statistics.heatPercent}% de la chaleur livrée annuellement par
                  les réseaux en France
                </div>
              </ArrowItem>
              <ArrowItem>
                <div className="text-lg text-grey!">
                  Des données techniques et économiques par réseau, l’identification des réseaux classés et leurs périmètres de
                  développement prioritaire, les tracés de réseaux en construction
                </div>
              </ArrowItem>
              <ArrowItem>
                <div className="text-lg text-grey!">
                  Des données sur les potentiels de raccordement à l’adresse : bâtiments chauffés au gaz ou fioul collectif, consommations
                  de gaz...
                </div>
              </ArrowItem>
              <ArrowItem>
                <div className="text-lg text-grey!">De nombreuses fonctionnalités pour les professionnels</div>
              </ArrowItem>
            </div>

            <div className="flex-1">
              <Heading size="h4" as="h3" color="blue-france">
                Un service gratuit au service de tous les acteurs de la filière des réseaux de chaleur
              </Heading>
              <ArrowItem>
                <div className="text-lg text-grey!">
                  Un ensemble d’accompagnements personnalisés pour les collectivités, les exploitants et les professionnels
                </div>
              </ArrowItem>
              <ArrowItem>
                <div className="text-lg text-grey!">Un contenu riche pour informer le grand public</div>
              </ArrowItem>
              <ArrowItem>
                <div className="text-lg text-grey!">Des infographies et des vidéos pédagogiques</div>
              </ArrowItem>
              <ArrowItem>
                <div className="text-lg text-grey!">
                  Des simulateurs (émissions de CO2 évitées et montant du «&nbsp;Coup de pouce chauffage des bâtiments résidentiels
                  collectifs et tertiaires&nbsp;»)
                </div>
              </ArrowItem>
            </div>
          </ResponsiveRow>
        </SectionContent>
      </Section>

      <Section variant="light" id="beneficier-du-service">
        <SectionTitle className="max-w-[680px]">
          Vous êtes une collectivité ou un exploitant <br />
          France Chaleur Urbaine vous permet de&nbsp;:
        </SectionTitle>
        <SectionContent>
          <ResponsiveRow>
            <div className="flex-1">
              <Image src="/img/collectivite_picto_1.webp" alt="" width="270" height="232" priority className="d-block img-object-contain" />
              <FeatureLink href="#communiquer" className="fr-mb-1w fr-mt-3w">
                Communiquer
              </FeatureLink>
              <div className="text-lg">
                Vous cherchez à faire connaître votre réseau et les avantages du chauffage urbain, encore mal connu&nbsp;?
              </div>
            </div>

            <div className="flex-1">
              <Image src="/img/collectivite_picto_2.webp" alt="" width="270" height="232" priority className="d-block img-object-contain" />
              <FeatureLink href="#prospecter" className="fr-mb-1w fr-mt-3w">
                Prospecter
              </FeatureLink>
              <div className="text-lg">
                Vous voulez accélérer les raccordements à un réseau et connaître toutes les demandes déposées sur notre plateforme&nbsp;?
              </div>
            </div>

            <div className="flex-1">
              <Image src="/img/collectivite_picto_3.webp" alt="" width="270" height="232" priority className="d-block img-object-contain" />
              <FeatureLink href="#developper" className="fr-mb-1w fr-mt-3w">
                Développer
              </FeatureLink>
              <div className="text-lg">
                Vous souhaitez développer vos réseaux et avoir une vision à long terme des potentiels sur votre territoire&nbsp;?
              </div>
            </div>
          </ResponsiveRow>
          <ResponsiveRow breakpoint="xs" justifyContent="center" gap="32px" mt="8w">
            <Link
              variant="primary"
              href="documentation/FCU_guide_collectivites.pdf"
              eventKey="Téléchargement|Guide Collectivités|Collectivités et exploitants"
              isExternal
            >
              Notre guide collectivité
            </Link>
            <Link
              variant="primary"
              href="documentation/FCU_guide_exploitants.pdf"
              eventKey="Téléchargement|Guide Exploitants|Collectivités et exploitants"
              isExternal
            >
              Notre guide exploitant
            </Link>
          </ResponsiveRow>
        </SectionContent>
      </Section>

      <Section id="communiquer">
        <SectionTitle>Communiquer</SectionTitle>
        <SectionSubtitle>
          France Chaleur Urbaine vous aide à faire la promotion du chauffage urbain et à rendre votre réseau plus visible en ligne et dans
          votre ville
        </SectionSubtitle>
      </Section>

      <Section variant="accent">
        <ResponsiveRow className="fr-container" textColor="white">
          <div className="flex-1">
            <div className="text-xl font-bold">
              Comme Charleville-Mézières, Fresnes ou Evos à Strasbourg, menez une campagne d’affichage ou communiquez pendant les travaux
            </div>
            <div className="text-lg mt-3w">
              Rendez visibles vos réseaux de chaleur via des campagnes d’affichage en ville&nbsp;! Les phases de travaux constituent aussi
              des moments clés pour faire connaître les réseaux&nbsp;: nous vous accompagnons dans cette communication.
            </div>

            <Link variant="primary" href="/ressources/actions-de-communication" mt="4w">
              Voir l’offre d’accompagement de campagne
            </Link>
          </div>
          <div className="flex-1">
            <CampagneAfficheImage src="/img/collectivite-campagne-affiches.webp" alt="Visuels de 4 affiches sur le chauffage urbain" />
          </div>
        </ResponsiveRow>
      </Section>

      <Section>
        <SectionContent>
          <SectionTwoColumns>
            <div>
              <SectionHeading size="h4" as="h3" color="blue-france">
                Diffusez nos supports pédagogiques
              </SectionHeading>
              <div className="text-lg">
                De nombreux documents à partager sur les réseaux sociaux, sur votre site internet et en mairie (infographies, visuels pour
                réseaux sociaux, vidéos, article type...). Vous souhaitez personnaliser ces supports avec votre logo&nbsp;? Il suffit pour
                cela de nous contacter.
              </div>
              <Link variant="primary" href="/ressources/supports#contenu" mt="3w">
                Voir tous nos supports
              </Link>
            </div>
            <div>
              <FullWidthImage src="/img/collectivite-supports.jpg" alt="Visuels de 4 supports pédagogiques sur le chauffage urbain" />
            </div>
          </SectionTwoColumns>
        </SectionContent>
      </Section>

      <Section variant="light">
        <SectionContent>
          <SectionTwoColumns>
            <div>
              <SectionHeading size="h4" as="h3" color="blue-france">
                Faites apparaître les données de votre réseau sur la cartographie France Chaleur Urbaine (tracé, projets d'extension,
                périmètre de développement prioritaire...)
              </SectionHeading>
              <div className="text-lg">
                Les copropriétaires et les gestionnaires d’établissements tertiaires de votre territoire pourront ainsi vérifier si un
                raccordement de leur bâtiment est envisageable.
              </div>
              <Link variant="primary" href="/contribution" mt="3w">
                Communiquer les données de mon réseau
              </Link>
              <div className="text-lg mt-3w">
                Vous pouvez ajouter des informations ou des précisions (capacité de raccordement, schéma directeur, évolution à venir, ...)
                sur la fiche de votre réseau.
              </div>
              <div className="flex mt-3w">
                <NetworkSearchInput
                  className={selectedNetwork ? '' : 'fr-col'} // expand the text input only
                  label={<div className="mt-2w text-blue">Voir la fiche actuelle de votre réseau</div>}
                  value={networkSearchTerm}
                  onChange={(value) => {
                    setNetworkSearchTerm(value);
                    setSelectedNetwork(null); // hide the link
                  }}
                  selectedNetwork={selectedNetwork}
                  onNetworkSelect={(network) => {
                    setSelectedNetwork(network);
                  }}
                />
                {selectedNetwork && (
                  <Link
                    href={`/reseaux/${selectedNetwork['Identifiant reseau']}`}
                    isExternal
                    mt="4w"
                    ml="2w"
                    className="fr-col--middle" // vertical alignment
                  >
                    Voir la fiche
                  </Link>
                )}
              </div>

              <Button
                href={`/reseaux/modifier${selectedNetwork ? `?reseau=${selectedNetwork['Identifiant reseau']}` : ''}`}
                disabled={!selectedNetwork}
                className="fr-mt-3w"
              >
                Compléter la fiche {selectedNetwork ? 'du' : 'd’un'} réseau
              </Button>
            </div>
            <div>
              <FullWidthImage src="/img/collectivite-carto.jpg" alt="Capture d'écran de la carte France Chaleur Urbaine" />
            </div>
          </SectionTwoColumns>
        </SectionContent>
      </Section>

      <Section>
        <IframeIntegration />
      </Section>

      <Section variant="light" id="prospecter">
        <SectionTitle>Prospecter</SectionTitle>
        <SectionSubtitle>
          France Chaleur Urbaine vous permet de découvrir les manifestions d’intérêt sur votre territoire ainsi que les demandes de contact
          déposées sur notre site.
        </SectionSubtitle>
        <SectionContent>
          <ResponsiveRow mt="10w">
            <div className="flex-1">
              <Heading size="h4" as="h3" color="blue-france">
                Identifiez les zones où une appétence se dénote
              </Heading>
              <div className="text-lg">Toutes les demandes effectuées sur notre site apparaissent directement sur notre cartographie</div>
            </div>
            <div className="flex-1">
              <FullWidthImage src="/img/collectivite-prospecter-1.jpg" alt="Capture d'écran de la carte France Chaleur Urbaine" />
            </div>
          </ResponsiveRow>

          <ResponsiveRow mt="10w">
            <div className="flex-1">
              <Heading size="h4" as="h3" color="blue-france">
                Profitez de notre « espace gestionnaire » ouvert aux exploitants et collectivités
              </Heading>
              <div className="text-lg">
                Découvrez qui souhaiterait se raccorder sur votre territoire en récupérant simplement les coordonnées des prospects
                raccordables.
                <br />
                Retrouvez l’ensemble des demandes reçues sur notre site près de votre/vos réseaux, dans un espace ergonomique partagé entre
                exploitants et autorité délégante, facile à prendre en main.
              </div>
            </div>
            <div className="flex-1">
              <FullWidthImage
                src="/img/collectivite-prospecter-2.jpg"
                alt="Capture d'écran de l'espace gestionnaire de France Chaleur Urbaine"
              />
            </div>
          </ResponsiveRow>
        </SectionContent>
      </Section>

      <Section id="developper">
        <SectionTitle>Développer</SectionTitle>
        <SectionSubtitle>
          Découvrez toutes les fonctionnalités de la cartographie pour vos actions de prospection et prospective.
        </SectionSubtitle>
        <SectionContent>
          <ResponsiveRow mt="10w">
            <div className="flex-1">
              <FullWidthImage
                src="/img/collectivite-developper-1.jpg"
                alt="Zoom sur les filtres de la consommation globale de gaz sur la carte France Chaleur Urbaine"
                width="80%"
              />
              <Heading size="h4" as="h3" color="blue-france" mt="4w">
                Identifiez les principaux consommateurs de gaz sur votre territoire
              </Heading>
              <div className="text-lg">
                Consommations de gaz à l’adresse, issues des données locales de l’énergie : une première donnée pour envisager la création
                d’un réseau de chaleur et identifier facilement les bâtiments gros consommateurs de gaz.
              </div>
            </div>

            <div className="flex-1">
              <FullWidthImage
                src="/img/collectivite-developper-2.jpg"
                alt="Zoom sur les filtres des bâtiments chauffés au gaz collectif et au fioul sur la carte"
                width="80%"
              />
              <Heading size="h4" as="h3" color="blue-france" mt="4w">
                Localisez les bâtiments à chauffage collectif gaz ou fioul potentiellement raccordables
              </Heading>
              <div className="text-lg">
                En complément des consommations de gaz, il peut être utile d’étudier les données bâtimentaires issues de la base de données
                nationale des bâtiments. Les données sont filtrables selon le nombre de lots d’habitation.
              </div>
            </div>
          </ResponsiveRow>

          <ResponsiveRow mt="10w">
            <div className="flex-1">
              <FullWidthImage
                src="/img/collectivite-developper-3.jpg"
                alt="Zoom sur l'outil d'extraction des données des bâtiments sur la carte France Chaleur Urbaine"
                width="80%"
              />
              <Heading size="h4" as="h3" color="blue-france" mt="4w">
                Exportez la totalité des informations sur une zone précise
              </Heading>
              <div className="text-lg">
                Définissez facilement une zone et obtenez les valeurs agrégées des consommations de gaz, adresses des bâtiments chauffés au
                gaz ou fioul collectif,... Et obtenez la liste des bâtiments par adresse postale pour prospecter efficacement.
                <br />
                Le nombre de lots par bâtiment est également indiqué dans l’export.
              </div>
            </div>

            <div className="flex-1">
              <FullWidthImage
                src="/img/collectivite-developper-4.jpg"
                alt="Zoom sur l'outil de calcul de densité thermique linéaire sur la carte France Chaleur Urbaine"
                width="80%"
              />
              <Heading size="h4" as="h3" color="blue-france" mt="4w">
                Définissez un projet de tracé de réseau
              </Heading>
              <div className="text-lg">
                La longueur du tracé prévisionnel et la densité thermique linéaire associée, sur la base des consommations de gaz à
                l’adresse, sont automatiquement calculées. Estimez ainsi le potentiel de création de futurs réseaux ou d’extensions de
                réseaux en quelques clics.
                <br />
                L’ADEME retient comme critère de densité énergétique minimale 1,5&nbsp;MWh par mètre linéaire de réseau.
              </div>
            </div>
          </ResponsiveRow>
        </SectionContent>
      </Section>

      <Section variant="accent">
        <SectionContent className="mt-0!">
          <SectionTwoColumns className="mt-0!">
            <SectionHeading size="h5" as="h4" className="mb-0!">
              Inscrivez-vous à notre newsletter pour recevoir toutes nos dernières infos
            </SectionHeading>
            <Newsletter />
          </SectionTwoColumns>
        </SectionContent>
      </Section>

      <Section variant="light">
        <SectionTitle>Nos articles sur le chauffage urbain</SectionTitle>
        <SectionContent>
          <Understanding cards={collectivitesCards} />
        </SectionContent>
      </Section>

      <Partners />

      <Section variant="accent">
        <SectionContent className="mt-0! flex flex-col gap-2">
          <SectionHeading size="h5" as="h3">
            Le chauffage urbain, un levier pour la transition énergétique
          </SectionHeading>
          <p>Accélérons le développement des réseaux de chaleur</p>
          <p>
            Le chauffage urbain, majoritairement mis en place à l'initiative des collectivités, permet de mobiliser des{' '}
            <Link href="/ressources/energies-vertes#contenu">sources d'énergie locales et renouvelables faiblement carbonées</Link>.
          </p>
          <p>
            La loi de transition énergétique pour la croissance verte fixe pour{' '}
            <RoutedLink href="/ressources/role#contenu">objectif de multiplier par 5</RoutedLink> les quantités de chaleur livrées par les
            réseaux en 2030, par rapport à 2012. Cela passera par la densification des réseaux de chaleur existants, la création
            d'extensions ou de nouveaux réseaux, et l'augmentation de la part des énergies renouvelables alimentant les réseaux de chaleur.
          </p>
        </SectionContent>
      </Section>
    </SimplePage>
  );
}

export default CollectivitesEtExploitantsPage;
